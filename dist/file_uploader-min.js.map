{"version":3,"sources":["../js/file_uploader.js","../js/_init.js","../js/_create_uploader.js","../js/_create_item.js","../js/_set_listeners.js","../js/_send_files.js","../js/_build_hidden_fields.js","../js/_create_info_text.js","../js/_set_options.js","../js/_funcs_and_params.js"],"names":["FileUploader2","upl","isSuitableBrowser","navigator","userAgent","indexOf","appVersion","div","document","createElement","window","init","user_global_options","global_options","setOptions","silent_degradation","alert","alert_messages","unsuitable_browser","unsuitable_browser_callback","css","head","insertAdjacentHTML","querySelectorAll","data_attributes","fupl_selector","forEach","upl_element","element_all_dataset","dataset","fupl_dataset","fupl_options","JSON","parse","element","uploader_url","Error","filetype","toLowerCase","Object","keys","mimetypes","e","console","error","json_params","i","item","concat","log","createUploader","_input","querySelector","original_label","accept_attr","accept_params","accept","split","map","trim","getAttribute","_toConsumableArray","Set","max_filesize","parse_max_filesize","locales","_fupl_options$wrapper","_fupl_options$istance","multiple","Boolean","hasAttribute","required","_type","_mode","uploader_legend_text","innerHTML","classList","add","wrapper","parentNode","insertBefore","appendChild","wrapper_extra_class","apply","uploader_legend","_class","uploader_legend_class","push","length","join","templates","main","istance_input","istance_label","istance_dd_text","istance_info_text","istance_result_wrapper","setAttribute","disabled","input_text","input_label_class","show_info_text","custom_info_text","create_info_text","values","_typeof","Array","isArray","createItem","set_has_values","setListeners","init_callback","debug","groupCollapsed","c_options","c_keys","sort","_toStringify","stringify","table","groupEnd","item_data","item_markup","fupl_item_wrapper","remove_btn","fupl_file_name","name","title","fupl_file_size","size_string","wi","he","size","parse_filesize","src","fupl_url","url","href","fupl_item","id","rel_id","item_id","loading","loading_element","addEventListener","remove","delete_varname","eventName","preventDefault","stopPropagation","element_dragover_class","files","dataTransfer","alert_api","too_much_files","sendFiles","filelist","disable_submit","modo","_form","closest","submit_btns","btn","uploadFile","current_item","img_preview","this_item","file","width","height","fupl_progress","fupl_loading_wrapper","xhr_error_message","xhr_error","replace","remove_item_on_error","click","upload_start_callback","uploader_options","Promise","resolve","reject","ajax","XMLHttpRequest","open","onload","status","response","responseText","tmp_file","upload_complete_callback","server_error","statusText","onerror","upload","alternate_loading_func","perc_loaded","Math","round","loaded","total","lengthComputable","Infinity","value","alternate_loading_progress","fileData","FormData","append","send","then","buildHiddenFields","filelist_item","idx","Date","ext","pop","type","file_format_error","maxbytes","item_parsed_size","file_size_error","feedback_size","reader","FileReader","image","Image","result","err_mes","img_w","img_exact_width_err","img_min_w","img_min_width_err","img_max_w","img_max_width_err","img_h","img_exact_height_err","img_min_h","img_min_height_err","img_max_h","img_max_height_err","img_err_start_string","readAsDataURL","errormessage","normalize_file_name","filename","converted","conversionTable","à","è","é","ì","ò","ù","À","È","É","Ì","Ò","Ù","'","|","!","\"","$","%","&","/","(",")","=","?","^","*","[","]","ç","@","#","<",">","ü","Ü","ñ","Ñ","~",":","\\","charCodeAt","charAt","hidden_fields","field_values","file_name","_key","varname","info_text","str","info_text_join_string","toUpperCase","slice","info_text_wrap_string","default_options","mes","opts","arguments","undefined","no_file","img","doc","single","reorder","reorder_varname","_len","custom_options","assign","_ret","_loop","v","auto","pdf","hasValues","items","bytes","mega","toLocaleString","maximumFractionDigits","filesize_value","unit","isNaN","substr"],"mappings":"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","sourcesContent":["/*!@preserve\n *\n * FileUploader 2.0\n * HTML5 / JS Async Uploader\n * Massimo Cassandro 2017-2019\n *\n */\n\n//* eslint no-console: 0, no-unused-vars: 0, no-empty:  0 */\n/* exported FileUploader2 */\n\n/*\n@codekit-append '_funcs_and_params.js'\n@codekit-append '_set_options.js'\n@codekit-append '_create_info_text.js'\n@codekit-append '_reorder.js'\n@codekit-append '_build_hidden_fields.js'\n@codekit-append '_send_files.js'\n@codekit-append '_set_listeners.js'\n@codekit-append '_create_item.js'\n@codekit-append '_create_uploader.js'\n\n@codekit-append '_init.js'\n\n*/\n\"use strict\";\nvar FileUploader2 = (function () {\n\n  let upl = {};\n\n  return upl;\n})();\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n\n  // VARIABILI E METODI PRIVATI\n  /*\n    isSuitableBrowser\n    Verifica che il browser sia in grado di gestire le funzionalità richieste.\n    Restituisce `true` o `false`\n  */\n  const isSuitableBrowser = () => {\n    // Eliminazione IE\n    if( navigator.userAgent.indexOf('MSIE') !== -1 ||\n    navigator.appVersion.indexOf('Trident/') > -1 ||\n    navigator.userAgent.indexOf('Trident/') > -1 ){\n      return false;\n    }\n\n    var div = document.createElement( 'div' );\n    return ( ( 'draggable' in div ) || ( 'ondragstart' in div && 'ondrop' in div ) )\n      && 'FormData' in window\n      && 'FileReader' in window\n      && 'fetch' in window;\n  };\n\n\n  /*\n    init\n    Seleziona gli elementi con l'attributo `fupl_selector` e avvia FileUploader\n    `user_global_options` è l'oggetto istanziato al momento di avviare FileUploader2,\n    ha la stessa struttura di `default_options` (definito in _set_options.js)\n    e può sovrascrivere ogni suo elemento\n  */\n  upl.init = (user_global_options) => {\n\n    const global_options = upl.setOptions(user_global_options);\n\n    // verifica che il browser sia compatibile\n    if( !isSuitableBrowser() ) {\n      if(!global_options.silent_degradation) {\n        alert(global_options.alert_messages.unsuitable_browser);\n      }\n      if(global_options.unsuitable_browser_callback && typeof global_options.unsuitable_browser_callback === 'function') {\n        global_options.unsuitable_browser_callback();\n      }\n      return;\n    }\n\n    // caricamento CSS\n    if(global_options.css) {\n      document.head.insertAdjacentHTML('beforeend',\n        '<link rel=\"stylesheet\" href=\"' + global_options.css + '\" type=\"text/css\" media=\"all\">'\n      );\n    }\n\n    // istanze uploader\n    //---------------------------------------------------\n    document.querySelectorAll('[data-' + upl.data_attributes.fupl_selector + ']').forEach( upl_element => {\n      /*\n        merge dei parametri inseriti tramite attributi `data`, in cui:\n\n        * `upl_element.dataset`:\n            tutti gli attributi inseriti singolarmente (es. data-filetype=\"img\")\n\n        * `upl_element.dataset[upl.data_attributes.fupl_selector]`:\n            attributi inseriti tramite json assegnato a `data- + 'upl.data_attributes.fupl_selector'`\n            (es data-file_uploader2='{\"filetype\":\"img\"}')\n\n        In caso di conflitto prevalgono gli ultimi\n      */\n\n      let element_all_dataset = upl_element.dataset,\n      fupl_dataset = upl_element.dataset[upl.data_attributes.fupl_selector],\n      fupl_options = {};\n\n      if(element_all_dataset === '') {\n        element_all_dataset = {};\n      }\n\n      if(fupl_dataset === '') {\n        fupl_dataset = {};\n      } else {\n        fupl_dataset = JSON.parse(fupl_dataset);\n      }\n\n      fupl_options = upl.setOptions(\n        global_options,\n        fupl_dataset,\n        element_all_dataset\n      );\n\n      // cancella la chiave `upl.data_attributes.fupl_selector`\n      // (al solo scopo di ridurre la confusione)\n      delete fupl_options[upl.data_attributes.fupl_selector];\n\n      // aggiunta dell'elemento stesso ad  `fupl_options`:\n      fupl_options.element = upl_element;\n\n      // controllo parametri e avvio uploader\n      try {\n        //  controllo url\n        if( !fupl_options.uploader_url ) {\n          throw new Error( \"Parametro `uploader_url` non impostato\" );\n        }\n\n        //  controllo parametro filetype\n        fupl_options.filetype = fupl_options.filetype.toLowerCase();\n        if( Object.keys(upl.mimetypes).indexOf(fupl_options.filetype) === -1 ) {\n          throw new Error( \"Parametro `filetype` non corretto\" );\n        }\n      } catch(e) {\n        console.error( e );// eslint-disable-line\n      }\n\n      // parametri che devono essere array e che potrebbero essere presenti\n      // come attributi data (stringa)\n      const json_params = [\n        'input_text',\n        'templates',\n        'info_text_wrap_string',\n        'values'\n      ];\n      json_params.forEach(item => {\n        try {\n          if(typeof fupl_options[item] === 'string' ) {\n            fupl_options[item] = JSON.parse(fupl_options[item]);\n          }\n        } catch(e) {\n          console.error(`L'elemento “${item}” non è un json valido`); // eslint-disable-line\n          console.log(fupl_options.element); // eslint-disable-line\n          console.error( e );// eslint-disable-line\n        }\n      });\n\n      // interpretazione automatica di tutti i parametri booleani o null\n      for(let i in fupl_options) {\n        if(typeof fupl_options[i] === 'string' &&\n          ['true', 'false', 'null'].indexOf(fupl_options[i].toLowerCase) !== -1) {\n          fupl_options[i] = JSON.parse(fupl_options[i]);\n        }\n      }\n\n\n      new upl.createUploader(fupl_options);\n    }); // end document.querySelectorAll(fupl_selector).forEach\n  }; // end upl.init\n\n  return upl;\n\n})(FileUploader2 || {});\n\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n\n  upl.createUploader = (fupl_options) => {\n\n    // eventuale campo input e relativo tag label\n    let _input = fupl_options.element.querySelector('input[type=\"file\"]'),\n      original_label = fupl_options.element.querySelector('label');\n\n\n    // implementazione eventuali parametro/attributo `accept`\n    if( fupl_options.filetype === 'auto' ) {\n\n      let accept_attr = [],\n      accept_params = [];\n\n      if( fupl_options.accept !== null ) {\n        accept_params = fupl_options.accept\n          .split(',').map( item => item.trim() );\n      }\n\n      if(_input && _input.getAttribute('accept') ) {\n        accept_attr = _input.getAttribute('accept')\n          .split(',').map( item => item.trim() );\n      }\n\n      // https://www.peterbe.com/plog/merge-two-arrays-without-duplicates-in-javascript\n      fupl_options.accept = [...new Set([...accept_params, ...accept_attr])];\n\n    } else {\n      fupl_options.accept = upl.mimetypes[fupl_options.filetype];\n    }\n\n    // elaborazione max_filesize\n    let max_filesize = upl.parse_max_filesize(fupl_options.max_filesize, fupl_options.locales);\n    if( max_filesize === false ) {\n      throw new Error( '\"' + fupl_options.max_filesize + '\" non è un valore corretto per `max_filesize`');\n    } else {\n      fupl_options.max_filesize = max_filesize;\n    }\n\n    // parametro o attributo multiple\n    fupl_options.multiple = Boolean(fupl_options.multiple ||\n      (_input && _input.hasAttribute('multiple') ));\n\n    // parametro o attributo required\n    fupl_options.required = Boolean(fupl_options.required ||\n      (_input && _input.hasAttribute('required') ));\n\n\n    // tipologia generale dell'uploader (img o doc) e modalità\n    // selezione file\n    fupl_options._type = fupl_options.filetype === 'img'? 'img' : 'doc';\n    fupl_options._mode = fupl_options.multiple? 'multiple' : 'single';\n\n    // testo label (da tag o parametro uploader_legend_text)\n    if( !fupl_options.uploader_legend_text && original_label) {\n      fupl_options.uploader_legend_text = original_label.innerHTML;\n    }\n    // caso in cui sia presente nessun valore\n    if ( !fupl_options.uploader_legend_text ) {\n      fupl_options.uploader_legend_text = '__label non presente__';\n    }\n\n    // aggiunta della classe principale\n    fupl_options.element.classList.add(\"fupl\");\n\n    // aggiunta wrapper\n    fupl_options.wrapper = document.createElement('fieldset');\n    fupl_options.element.parentNode.insertBefore(fupl_options.wrapper, fupl_options.element);\n    fupl_options.wrapper.appendChild(fupl_options.element);\n    fupl_options.wrapper.classList.add(\"fupl-wrapper\");\n    fupl_options.wrapper.classList.add(\"fupl-type-\" + fupl_options._type );\n    if(fupl_options.multiple) {\n      fupl_options.wrapper.classList.add(\"fupl-multiple\");\n    }\n    // aggiunta eventuali classi personalizzate\n    if( fupl_options.wrapper_extra_class ) {\n      fupl_options.wrapper.classList.add( ...fupl_options.wrapper_extra_class.split(' ') );\n    }\n\n    // aggiunta legend uploader\n    if( fupl_options.uploader_legend ) {\n      let _class = ['fupl-legend'];\n      if( fupl_options.uploader_legend_class ) {\n        _class.push(fupl_options.uploader_legend_class);\n      }\n      if( fupl_options.required ) {\n        _class.push('required');\n      }\n\n      fupl_options.element.insertAdjacentHTML('beforebegin',\n        '<legend' + (_class.length? ' class=\"' + _class.join(' ') + '\"' : '') + '>' +\n          fupl_options.uploader_legend_text +\n        '</legend>'\n      );\n      fupl_options.wrapper.classList.add( 'fupl-has-legend' );\n    }\n\n    // aggiunta template uploader\n    fupl_options.element.innerHTML = fupl_options.templates.main;\n\n    fupl_options.istance_input = fupl_options.element.querySelector('.fupl-panel input[type=\"file\"]');\n    fupl_options.istance_label = fupl_options.element.querySelector('.fupl-panel label');\n    fupl_options.istance_dd_text = fupl_options.element.querySelector('.fupl-panel .fupl-dd-text');\n    fupl_options.istance_info_text = fupl_options.element.querySelector('.fupl-panel .fupl-info-text');\n    fupl_options.istance_result_wrapper = fupl_options.element.querySelector('.fupl-result');\n\n\n    // inserimento testi e attributi\n    // if( fupl_options.required ) {\n    //   fupl_options.istance_input.setAttribute('required', '');\n    // }\n    if( fupl_options.multiple ) {\n      fupl_options.istance_input.setAttribute('multiple', '');\n    }\n    if( fupl_options.accept !== null ) {\n      fupl_options.istance_input.setAttribute('accept', fupl_options.accept.join(','));\n    }\n\n    // aggiunta attributo data al wrapper per segnalare il required\n    if( fupl_options.required ) {\n      fupl_options.wrapper.dataset[upl.data_attributes.required] = 'true';\n    }\n\n    // aggiunta attributo disabled al wrapper\n    if( fupl_options.disabled ) {\n      fupl_options.wrapper.setAttribute('disabled', true);\n      fupl_options.wrapper.setAttribute('aria-disabled', true);\n    }\n\n\n    fupl_options.istance_label.insertAdjacentHTML('beforeend',\n      fupl_options.input_text[fupl_options._type][fupl_options._mode][0]\n    );\n    if(fupl_options.input_label_class) {\n      fupl_options.istance_label.classList.add(...fupl_options.input_label_class.split(' '));\n    }\n    fupl_options.istance_dd_text.innerHTML = fupl_options.input_text[fupl_options._type][fupl_options._mode][1];\n\n    // info text\n    if( fupl_options.show_info_text ) {\n      if(fupl_options.custom_info_text) {\n        fupl_options.istance_info_text.innerHTML = fupl_options.custom_info_text;\n      } else {\n        fupl_options.istance_info_text.innerHTML = upl.create_info_text(fupl_options);\n      }\n    }\n\n    // aggiunta valori\n    // se values esiste ma è un oggetto, viene inserito in un array (non è garanzia di funzionamento)\n    // se è un altro tipo di variabile viene generato un errore\n    if(fupl_options.values) {\n      if(typeof fupl_options.values === 'object') {\n        if(!Array.isArray(fupl_options.values)) {\n          fupl_options.values = [fupl_options.values];\n        }\n      } else {\n        console.error(\"Il parametro `values` non è corretto\"); // eslint-disable-line\n      }\n    }\n\n    if( fupl_options.values && fupl_options.values.length ) {\n\n      fupl_options.values.forEach( item => {\n        upl.createItem(item, fupl_options);\n      });\n\n    }\n    upl.set_has_values(fupl_options);\n\n    // gestione aggiunta nuovi elementi\n    upl.setListeners(fupl_options);\n\n\n    // esecuzione init_callback, se presente\n    if( fupl_options.init_callback !== null ) {\n      fupl_options.init_callback( fupl_options );\n    }\n\n\n    //debug\n    if( fupl_options.debug ) {\n      /* eslint-disable */\n      console.groupCollapsed('FileUploader options');\n      // creazione di un oggetto bidimensinale per\n      // semplificare la rappresentazione in tabella\n      let c_options = {},\n      c_keys = Object.keys(fupl_options);\n      c_keys.sort();\n      c_keys.forEach(item => {\n        let _toStringify = typeof fupl_options[item] === 'object' &&\n        fupl_options[item] !== null &&\n          item !== 'element';\n        c_options[item] = _toStringify ? JSON.stringify(fupl_options[item], null, ' ') : fupl_options[item];\n      });\n      console.table(c_options);\n      console.groupCollapsed('fupl_options');\n        console.log(fupl_options);\n      console.groupEnd();\n      console.groupEnd();\n      /* eslint-enable */\n    } // end if debug\n\n\n  }; // end upl.createUploader\n\n  return upl;\n\n})(FileUploader2 || {});\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n\n\n  /*\n  Aggiunge un elemento a fupl_options.istance_result_wrapper\n  e imposta i necessari listeners\n\n  item_data è l'oggetto con i dati dell'elemento:\n\n  {\n    id    → identificativo univoco del file (può essere anche il percorso sul server)\n    name  → nome del file\n    url   → url per eventuale tag <a> presente nell'elemento (se immagine può essere assente o null)\n    src   → attributo `src` obbligatorio se immagine, oppure assente o null\n    wi    → larghezza in px se immagine oppure assente o null\n    he    → altezza in px se immagine oppure assente o null\n    size  → dimensione in bytes\n    loading → true se se si tratta di un elemento in fase di upload\n    [...] → eventuali campi aggiuntivi specifici dell'istanza\n  }\n\n  */\n\n  upl.createItem = (item_data, fupl_options) => {\n\n    try {\n\n      let item_markup = fupl_options.templates[fupl_options._type][fupl_options._mode];\n      if( item_markup === null && fupl_options._mode === 'multiple' ) {\n        item_markup = fupl_options.templates[fupl_options._type]['single'];\n      }\n\n      let fupl_item_wrapper = document.createElement('div'); // wrapper da rimuovere al momento dell'inserimento\n      fupl_item_wrapper.innerHTML = item_markup;\n\n      // aggiunta pulsante rimozione\n      fupl_item_wrapper.querySelector('.fupl-remove').innerHTML = fupl_options.templates.remove_btn;\n\n\n\n      /*\n        aggiunta dati specifici dell'elemento:\n\n        elementi interni a fupl-item:\n          .fupl-file-name\n          .fupl-file-size\n          .fupl-img →  img\n          .fupl-img → a.href\n          .fupl-doc →  a.href\n\n      */\n\n      // nome file\n      let fupl_file_name = fupl_item_wrapper.querySelector('.fupl-file-name');\n      if(fupl_file_name && item_data.name ) {\n        fupl_file_name.innerHTML = item_data.name;\n        fupl_file_name.title = item_data.name;\n      }\n\n      // info dimensioni\n      let fupl_file_size = fupl_item_wrapper.querySelector('.fupl-file-size');\n      if(fupl_file_size ) {\n        let size_string = '';\n        if(fupl_options._type === 'img' && item_data.wi && item_data.he) {\n          size_string = item_data.wi + '&times;' + item_data.he + '<span class=\"fupl-unit\">px</span>';\n          if(item_data.size) {\n            size_string += ' &ndash; ';\n          }\n        }\n        if(item_data.size) {\n          size_string += upl.parse_filesize(item_data.size, fupl_options.locales);\n        }\n\n        fupl_file_size.innerHTML = size_string;\n      }\n\n      // immagine\n      if( fupl_options._type === 'img' ) {\n        fupl_item_wrapper.querySelector('.fupl-img').src = item_data.src;\n      }\n\n      // url\n      let fupl_url = fupl_item_wrapper.querySelector('.fupl-url');\n      if( fupl_url && item_data.url) {\n        fupl_url.href = item_data.url;\n      }\n\n      let fupl_item = fupl_item_wrapper.querySelector('.fupl-item');\n      // id elemento per eventuale cancellazione\n      // se esiste rel_id, viene utilizzato quello\n      if(item_data.id || item_data.rel_id) {\n        fupl_item.dataset[upl.data_attributes.item_id] = item_data.rel_id? item_data.rel_id : item_data.id;\n      }\n\n      if(item_data.loading) {\n        fupl_item.classList.add('fupl-is-uploading');\n        fupl_item.insertAdjacentHTML('beforeend',\n          fupl_options.templates.loading_element\n        );\n      }\n\n      if(fupl_options._mode === 'single') {\n        fupl_options.istance_result_wrapper.innerHTML = fupl_item_wrapper.innerHTML;\n      } else {\n\n        // se non esistono elementi caricati predentemente, si svuota il div per\n        // eliminare la scritta no file\n        if( !fupl_options.istance_result_wrapper.querySelector('.fupl-item')) {\n          fupl_options.istance_result_wrapper.innerHTML = '';\n        }\n\n        fupl_options.istance_result_wrapper.insertAdjacentHTML('beforeend',\n          fupl_item_wrapper.innerHTML\n        );\n      }\n\n      // aggiunta evento trigger eliminazione elemento\n      fupl_item_wrapper = fupl_options.istance_result_wrapper.querySelector('.fupl-item:last-child');\n      fupl_item_wrapper.querySelector('.fupl-remove-trigger').addEventListener('click', () => {\n        // se l'id non è impostato si tratta di un nuovo elemento,\n        // e non va eseguita la cancellazione sul server\n        let id = fupl_item_wrapper.dataset[upl.data_attributes.item_id];\n        fupl_item_wrapper.remove();\n        if(id) {\n          fupl_options.wrapper.insertAdjacentHTML('beforeend',\n            `<input type=\"hidden\" name=\"${fupl_options.delete_varname}\" value=\"${id}\">`\n          );\n        }\n\n        // controllo se istance_result_wrapper è vuoto\n        // e impostazione di attributo e contenuti\n        upl.set_has_values(fupl_options);\n\n      });\n\n      return fupl_options.istance_result_wrapper.querySelector('.fupl-item:last-child');\n\n    } catch(e) {\n      console.error(e); // eslint-disable-line\n    }\n\n  }; // end upl.createItem\n\n  return upl;\n\n})(FileUploader2 || {});\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n\n  // https://www.smashingmagazine.com/2018/01/drag-drop-file-uploader-vanilla-js/\n  upl.setListeners = (fupl_options) => {\n\n    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n      fupl_options.element.addEventListener(eventName, (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n      }, false);\n    });\n\n    ['dragover', 'dragenter'].forEach(eventName => {\n      fupl_options.element.addEventListener(eventName, () => {\n        fupl_options.element.classList.add( fupl_options.element_dragover_class );\n      }, false);\n    });\n\n    ['dragleave', 'dragend'].forEach(eventName => {\n      fupl_options.element.addEventListener(eventName, () => {\n        fupl_options.element.classList.remove( fupl_options.element_dragover_class );\n      }, false);\n    });\n\n    fupl_options.element.addEventListener('drop', (e) => {\n      fupl_options.element.classList.remove( fupl_options.element_dragover_class );\n\n      if(!fupl_options.wrapper.hasAttribute('disabled')) {\n        let files = e.dataTransfer.files;\n\n        if( !fupl_options.multiple && files.length > 1 ) {\n          fupl_options.alert_api(fupl_options.alert_messages.too_much_files, fupl_options);\n        } else {\n          upl.sendFiles( files, fupl_options );\n        }\n      }\n    }, false);\n\n    // selezione tramite input\n    fupl_options.istance_input.addEventListener('change', () => {\n      upl.sendFiles( fupl_options.istance_input.files, fupl_options );\n    });\n\n  }; // end upl.createItem\n\n  return upl;\n\n})(FileUploader2 || {});\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n\n  /*\n\tsendFiles\n\tEsegue i controlli impostati, quindi la chiamata ajax e produce\n\til feedback per l'utente\n\t*/\n  upl.sendFiles = (filelist, fupl_options) => {\n\n\n    /*\n    disable_submit\n    disabilita il form fino a caricamento completato\n    */\n    const disable_submit = (modo) => {\n      // modo === true → disable, false → enable\n      const _form = fupl_options.element.closest('form');\n\n      if(fupl_options.disable_submit && _form) {\n        const submit_btns = _form.querySelectorAll('[type=\"submit\"]');\n\n        submit_btns.forEach( btn => {\n          btn.disabled = modo;\n        });\n\n        //BUG il listener non viene rimosso con modo == false\n        // const submitHandler = (e) => {\n        //   e.preventDefault();\n        //   //return false;\n        // };\n        // if(modo === true) {\n        //   _form.addEventListener('submit', submitHandler);\n        // } else {\n        //   if( !fupl_options.istance_result_wrapper.querySelector('.fupl-item.fupl-is-uploading')) {\n        //     _form.removeEventListener('submit', submitHandler);\n        //   }\n        // }\n      }\n    },\n\n    /*\n    uploadFile\n    esegue l'upload Ajax\n    https://www.smashingmagazine.com/2018/01/drag-drop-file-uploader-vanilla-js/\n\n    current_item contiene:\n      - `id`: id univoco dell'elemento\n      - `file`: oggetto filelist\n      - `width` e height: dimensioni in pixel dell'immagine.\n                  null se non si tratta di immagini\n      - `tmp_file`: nel caso di nuovi elementi: nome del file temporaneo\n\n    */\n    uploadFile = function ( current_item, img_preview ) {\n\n      // disabilitazione form\n      disable_submit(true);\n\n      // aggiunta elemento all'uploader\n      let this_item = upl.createItem({\n          id   : null,\n          name : current_item.file.name,\n          url  : null,\n          src  : img_preview,\n          wi   : current_item.width,\n          he   : current_item.height,\n          size : current_item.file.size,\n          loading:true\n      }, fupl_options),\n\n      fupl_progress= this_item.querySelector('.fupl-progress'),\n      fupl_loading_wrapper = this_item.querySelector('.fupl-loading'),\n\n      xhr_error_message = fupl_options.alert_messages.xhr_error.replace(/{{file_name}}/, current_item.file.name);\n\n      //console.log(this_item); // eslint-disable-line\n\n      const remove_item_on_error = () => {\n        this_item.querySelector('.fupl-remove-trigger').click();\n      };\n\n      /*\n      Funzione callback personalizzata\n      Vedi `_set_options.js` per tutti i parametri\n      */\n      if( fupl_options.upload_start_callback && typeof fupl_options.upload_start_callback === 'function') {\n        fupl_options.upload_start_callback({\n          'item'              : current_item,\n          'img_preview'       : img_preview,\n          'uploader_options'  : fupl_options\n        });\n      }\n\n      new Promise(function(resolve, reject) {\n        let ajax = new XMLHttpRequest();\n        ajax.open( 'POST', fupl_options.uploader_url, true );\n\n        ajax.onload = function() {\n\n          if( ajax.status >= 200 && ajax.status < 400 ) {\n\n            const response = JSON.parse( ajax.responseText );\n\n            /*\n              jsonResponse:\n              {\n                \"tmp_file\": \"file_temporaneo\",\n                \"error\": null\n              }\n            */\n            if(response.error) {\n\n              fupl_options.alert_api( xhr_error_message, fupl_options );\n              /* eslint-disable */\n              console.error( response.error );\n              /* eslint-enable */\n\n              reject();\n\n            } else {\n              current_item.tmp_file = response.tmp_file;\n              resolve();\n            }\n\n            /*\n            Funzione callback personalizzata\n            Vedi `_set_options.js` per tutti i parametri\n            */\n            if( fupl_options.upload_complete_callback && typeof fupl_options.upload_complete_callback === 'function') {\n              fupl_options.upload_complete_callback({\n                'item'          : current_item,\n                'server_error'  : response.error,\n                'fupl_options'  : fupl_options\n              });\n            }\n\n\n          } else {\n            fupl_options.alert_api( xhr_error_message, fupl_options );\n            /* eslint-disable */\n            console.error( ajax.status, ajax.statusText );\n            console.error( ajax.responseText );\n            /* eslint-enable */\n          }\n\n          reject();\n        };\n\n        ajax.onerror = function() {\n          fupl_options.alert_api( xhr_error_message, fupl_options );\n          /* eslint-disable */\n          if(fupl_options.debug) {\n            console.error( ajax.status,  ajax.statusText );\n            console.error( ajax.responseText );\n          }\n          /* eslint-enable */\n\n          reject();\n        };\n\n        ajax.upload.addEventListener('progress', function (e) {\n          if( fupl_options.alternate_loading_func &&\n            typeof fupl_options.alternate_loading_func === 'function') {\n              fupl_options.alternate_loading_func(e, fupl_options);\n\n          } else {\n            let perc_loaded = Math.round(e.loaded / e.total * 100.0) || 0;\n\n            //console.log(e.loaded ,e.total, perc_loaded); // eslint-disable-line\n            if(fupl_progress) {\n              if(e.lengthComputable) {\n                perc_loaded = perc_loaded === Infinity? 100 : perc_loaded;\n                this_item.querySelector('.fupl-progress').value = perc_loaded;\n              } else {\n                fupl_loading_wrapper.innerHTML = fupl_options.templates.alternate_loading_progress;\n                fupl_progress = null;\n              }\n            }\n          }\n        }, false);\n\n\n        let fileData = new FormData();\n        fileData.append('file', current_item.file);\n        ajax.send( fileData );\n      }) // end promise\n      .then(\n        // resolve\n        function (  ) {\n          //console.log('resolve'); // eslint-disable-line\n          this_item.classList.remove('fupl-is-uploading');\n          this_item.querySelector('.fupl-loading').remove(); // elemento loading\n\n          this_item.insertAdjacentHTML('beforeend',\n            upl.buildHiddenFields(current_item, fupl_options)\n          );\n\n          upl.set_has_values(fupl_options);\n\n          //Se non ci sono altri elemento in caricamento, disable_submit viene annullato\n          disable_submit(false);\n\n        },\n        //reject\n        function (  ) {\n          //console.log('reject'); // eslint-disable-line\n          remove_item_on_error();\n          upl.set_has_values(fupl_options);\n        }\n      );\n\n    };\n\n    if( filelist.length ) {\n\n      // https://stackoverflow.com/questions/38362231/\n      //how-to-use-promise-in-foreach-loop-of-array-to-populate-an-object\n      [...filelist].forEach(function (filelist_item, idx) {\n        try {\n\n          let current_item = {\n            id: 'fupl_item_' + (+new Date()) + '_' + idx, // id unico\n            file: filelist_item,\n            width: null,\n            height: null,\n            tmp_file: null\n          };\n\n          // controllo filetype (per drag&drop e browser che non supportano accept)\n          if( fupl_options.accept.length ) {\n            let ext = filelist_item.name.split('.').pop().toLowerCase();\n            if( fupl_options.accept.indexOf( filelist_item.type ) === -1 &&\n              fupl_options.accept.indexOf( '.' + ext ) === -1) {\n\n              throw fupl_options.alert_messages.file_format_error\n                .replace(/{{file_name}}/, filelist_item.name );\n            }\n          } // end controllo filetype\n\n          // controllo maxfilesize\n          if( fupl_options.max_filesize !== null ) {\n            if( filelist_item.size > fupl_options.max_filesize.maxbytes ) {\n              let item_parsed_size = upl.parse_filesize(filelist_item.size, fupl_options.locales);\n\n              throw fupl_options.alert_messages.file_size_error\n                .replace(/{{file_name}}/, filelist_item.name )\n                .replace(/{{file_size}}/, item_parsed_size )\n                .replace(/{{allowed_size}}/, fupl_options.max_filesize.feedback_size );\n\n            }\n          } // end controllo maxfilesize\n\n          // analisi immagine e caricamento\n          if(fupl_options.filetype === 'img') {\n\n            let reader  = new FileReader();\n            reader.addEventListener(\"load\", function () {\n\n              let image = new Image();\n              image.src = reader.result;\n              image.addEventListener(\"load\", function () {\n\n                let err_mes = [];\n                current_item.width=image.width;\n                current_item.height=image.height;\n\n                if( fupl_options.img_w && image.width !== fupl_options.img_w ) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_exact_width_err\n                      .replace(/{{image_dimension}}/, image.width)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_w)\n                  );\n\n                } else if(fupl_options.img_min_w && image.width < fupl_options.img_min_w) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_min_width_err\n                      .replace(/{{image_dimension}}/, image.width)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_min_w)\n                  );\n\n                } else if(fupl_options.img_max_w && image.width > fupl_options.img_max_w) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_max_width_err\n                      .replace(/{{image_dimension}}/, image.width)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_max_w)\n                  );\n                }\n\n                if (fupl_options.img_h && image.height !== fupl_options.img_h) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_exact_height_err\n                      .replace(/{{image_dimension}}/, image.height)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_h)\n                  );\n\n                } else if(fupl_options.img_min_h && image.height < fupl_options.img_min_h) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_min_height_err\n                      .replace(/{{image_dimension}}/, image.height)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_min_h)\n                  );\n\n                } else if(fupl_options.img_max_h && image.height > fupl_options.img_max_h) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_max_height_err\n                      .replace(/{{image_dimension}}/, image.height)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_max_h)\n                  );\n                }\n\n                if( err_mes.length ) {\n                  fupl_options.alert_api(\n                    fupl_options.alert_messages.img_err_start_string\n                    .replace(/{{file_name}}/, filelist_item.name ) + '<br>' +\n                    '<ul><li>' + err_mes.join('</li><li>') + '</li></ul>',\n                  fupl_options );\n\n                } else {\n                  uploadFile( current_item, reader.result );\n                }\n\n              }, false); // end image.addEventListener(\"load\"\n\n            }, false); // end reader.addEventListener(\"load\"\n\n            reader.readAsDataURL( filelist_item );\n\n          } else { // non immagine\n            uploadFile( current_item );\n\n          } // end if image\n\n        } catch (errormessage) {\n          fupl_options.alert_api( errormessage, fupl_options );\n        }\n      }); // end foreach\n\n    } // end if( filelist.length )\n\n  }; // end upl.sendFiles\n\n  return upl;\n\n})(FileUploader2 || {});\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n\n  /*\n    elimina i caratteri ascii > 127\n    Restituisce la stringa normalizzata\n  */\n  const normalize_file_name = function (filename) {\n    let converted = \"\";\n    const conversionTable = { // Reference table Unicode vs ASCII\n      'à' : 'a', // 224\n      'è' : 'e', // 232\n      'é' : 'e', // 233\n      'ì' : 'i', // 236\n      'ò' : 'o', // 242\n      'ù' : 'u', // 249\n      'À' : 'A', // 192\n      'È' : 'E', // 200\n      'É' : 'E', // 201\n      'Ì' : 'I', // 204\n      'Ò' : 'O', // 210\n      'Ù' : 'U', // 217\n      \"'\" : '_', // 39\n      '|' : '_', // 124\n      '!' : '_', // 33\n      '\"' : '_', // 34\n      '$' : '_', // 36\n      '%' : '_', // 37\n      '&' : '_', // 38\n      '/' : '_', // 47\n      '(' : '_', // 40\n      ')' : '_', // 41\n      '=' : '_', // 61\n      '?' : '_', // 63\n      '^' : '_', // 94\n      '*' : '_', // 42\n      '[' : '_', // 91\n      ']' : '_', // 93\n      'ç' : 'c', // 231\n      '@' : '_', // 64\n      '#' : '_', // 35\n      '<' : '_', // 60\n      '>' : '_', // 62\n      'ü' : 'u', // 252\n      'Ü' : 'U', // 220\n      'ñ' : 'n', // 241\n      'Ñ' : 'N', // 209\n      '~' : '_', // 126\n      ':' : '_',\n      '\\\\' : '_'\n    };\n\n    for(var i = 0; i < filename.length; i++) {\n      if( filename[i] in conversionTable) {\n        converted += conversionTable[filename[i]];\n\n      } else if(filename.charCodeAt(i) === 768 || filename.charCodeAt(i) === 769 ) { // accento grave e accento acuto\n        converted += '';\n\n      } else if(filename.charCodeAt(i) > 127 ) {\n        converted += '_';\n\n      } else {\n        converted += filename.charAt(i);\n      }\n    }\n\n    return converted.replace(/ /g, '_').replace(/_+/g, '_');\n  };\n\n  /*\n  buildHiddenFields\n  genera i campi hidden con i valori da restituire al server.\n  Restituisce la stringa dei campi hidden\n  */\n  upl.buildHiddenFields = (current_item, fupl_options) => {\n\n    let hidden_fields = '',\n    field_values = {\n      'tmp_file'  : current_item.tmp_file,\n      'file_name' : normalize_file_name(current_item.file.name),\n      'size'      : current_item.file.size,\n      'type'      : current_item.file.type\n    };\n\n    if(fupl_options._type === 'img') {\n      field_values.width = current_item.width;\n      field_values.height = current_item.height;\n    }\n\n    for (let _key in field_values) {\n      hidden_fields += '<input type=\"hidden\" '+\n        'name=\"' + fupl_options.varname + '[' + current_item.id +'][' + _key + ']\" '+\n        'value=\"' + field_values[_key] +'\">';\n    }\n\n    return '<div class=\"fupl-hiddens\">' + hidden_fields + '</div>';\n\n  };\n\n  return upl;\n\n})(FileUploader2 || {});\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n  \"use strict\";\n\n\n  /**\n\t * create_info_text\n\t * (funzione) Genera la stringa riepilogativa delle limitazioni da rispettare\n\t * per la selezione dei file\n\t *\n   * - Restituisce la stringa informativa\n\t */\n\tupl.create_info_text = fupl_options => {\n    let info_text = [];\n\n    if( fupl_options.filetype === 'img' ) {\n      info_text.push( 'immagini in formato <strong>JPEG</strong>, <strong>PNG</strong>, <strong>GIF</strong> o <strong>WEBP</strong>' );\n\n      if( fupl_options.img_w && fupl_options.img_h ) {\n        info_text.push( 'dimensioni: <strong>' +  fupl_options.img_w + '&times;' + fupl_options.img_h + 'px</strong>');\n\n      } else {\n\n        if(fupl_options.img_w && fupl_options.img_h && fupl_options.img_w === fupl_options.img_h) {\n          info_text.push( 'larghezza e altezza <strong>' +  fupl_options.img_h + 'px</strong>');\n\n        } else if(fupl_options.img_min_w && fupl_options.img_min_h && fupl_options.img_min_w === fupl_options.img_min_h) {\n          info_text.push( 'larghezza e altezza non inferiori a <strong>' +  fupl_options.img_min_w + 'px</strong>');\n\n        } else if(fupl_options.img_max_w && fupl_options.img_max_h && fupl_options.img_max_w === fupl_options.img_max_h) {\n          info_text.push( 'larghezza e altezza non superiori a <strong>' +  fupl_options.img_max_w + 'px</strong>');\n\n        } else {\n\n          if( fupl_options.img_w ) {\n            info_text.push( 'larghezza <strong>' +  fupl_options.img_w + 'px</strong>');\n\n          } else if( fupl_options.img_min_w && fupl_options.img_max_w ) {\n            info_text.push( 'larghezza compresa tra <strong>' +  fupl_options.img_min_w + 'px</strong> e <strong>' + fupl_options.img_max_w + 'px</strong>');\n\n          } else if( fupl_options.img_min_w ) {\n            info_text.push( 'larghezza non inferiore a <strong>' +  fupl_options.img_min_w + 'px</strong>');\n\n          } else if( fupl_options.img_max_w  ) {\n            info_text.push( 'larghezza non superiore a <strong>' +  fupl_options.img_max_w + 'px</strong>');\n          }\n\n          if( fupl_options.img_h ) {\n            info_text.push( 'altezza <strong>' +  fupl_options.img_h + 'px</strong>');\n\n          } else if( fupl_options.img_min_h && fupl_options.img_max_h ) {\n            info_text.push( 'altezza compresa tra <strong>' +  fupl_options.img_min_h + 'px</strong> e <strong>' + fupl_options.img_max_h + 'px</strong>');\n\n          } else if( fupl_options.img_min_h ) {\n            info_text.push( 'altezza non inferiore a <strong>' +  fupl_options.img_min_h + 'px</strong>');\n\n          } else if( fupl_options.img_max_h  ) {\n            info_text.push( 'altezza non superiore a <strong>' +  fupl_options.img_max_h + 'px</strong>');\n          }\n        }\n      }\n\n    } else if( fupl_options.filetype === 'pdf' ) {\n      info_text.push( 'file in formato <strong>PDF</strong>' );\n    }\n\n    if( fupl_options.max_filesize !== null ) {\n      info_text.push( 'max <strong>' + fupl_options.max_filesize.feedback_size + '</strong>' );\n    }\n\n    let str = info_text.join(fupl_options.info_text_join_string);\n    str = str.charAt(0).toUpperCase() + str.slice(1);\n\n    if(fupl_options.info_text_wrap_string && str) {\n      str = fupl_options.info_text_wrap_string[0] + str + fupl_options.info_text_wrap_string[1];\n    }\n    return str;\n\t};\n\n  return upl;\n\n})(FileUploader2 || {});\n","/* globals FileUploader2:true */\n\nFileUploader2 = ( (upl) => {\n\n  // parametri di default condivisi da tutte le istanze\n  const default_options = {\n\n    /*\n    silent_degradation\n    se true e il browser non ha le funzionalità richieste, fileuploader\n    non dà nessun messaggio di errore ed è possibile gestire l'upload dei file con\n    un classico input file. È però necessario che sia presente nel markup\n    (all'interno dell'elemento a cui si istanzia l'uploader) e che la cosa sia\n    gestita anche lato server\n    */\n    silent_degradation: false,\n\n    // callback da richiamere se viene rilevato un browser non adatto\n    unsuitable_browser_callback: null,\n\n    // percorso del css FileUploader\n    css: null,\n\n    // Attiva la modalità debug che mostra in console le informazioni\n    // sulla configurazione corrente\n    debug: false,\n\n    // locales string, usata per la formattazione della stringa numerica\n    // mostrata all'utente ricavata da `max_filesize`\n    locales: 'it-IT',\n\n    /*\n    Se true impedisce il caricamento di elementi\n    NB: in questa versione di FileUploader non eiste una vera gestione dello stato disabled,\n    la modifica di questa parametro influisce solo inizialmente sull'evento drag&drop\n    e sull'impostazione dello stato disabled del fieldset che racchiude l'uploader (.fupl-wrapper).\n    Eventuali modifiche \"in corsa\" dello stato disabled vanno gestite dalle singole applicazioni agendo sull'attributo\n    disabled dell'elemento fieldset.fupl-wrapper\n\n    La presenza dell'attributo disabled nell'elemento .fupl-wrapper disabilita l'elemento\n    input[type=file] generato da FileUploader (comportamento std di HTML 5) e impedisce il drag&drop\n    */\n    disabled: false,\n\n    // Interfaccia per l'invio di messaggi di errore\n    // mes  →  chiave dell'oggetto `alert_messages` con il testo del messaggio di errore\n    // type →  uno tra info, error, warning\n    // opts →  l'oggetto file uploader options corrente\n    alert_api: (mes, opts, type = error) => { window.alert(opts.alert_messages.mes);}, // eslint-disable-line\n\n    // testo dei messaggi errore\n    // eventuali segnaposti sono sotituiti nell'applicazione\n    alert_messages: {\n      // messaggio browser non compatibile\n      unsuitable_browser: 'Il tuo browser non ha tutte le funzionalità richieste ' +\n      'da questa applicazione.\\n' +\n      'Utilizza la versione più recente di Firefox, Edge, Safari, Opera o Chrome',\n\n      too_much_files: 'Puoi selezionare un solo file!', // tentativo di trascinare più file con uploader singolo\n      xhr_error: 'Si &egrave; verificato un errore nel caricamento del file &ldquo;<strong>{{file_name}}</strong>&rdquo;.', // errore ajax\n      file_format_error: 'Il file &ldquo;<strong>{{file_name}}</strong>&rdquo; &egrave; di un formato non consentito',\n      file_size_error: 'Le dimensioni di &ldquo;<strong>{{file_name}}</strong>&rdquo; ({{file_size}}) '+\n        'superano il valore massimo consentito ({{allowed_size}})',\n\n      // immagini\n      img_err_start_string: \"L'immagine &ldquo;<strong>{{file_name}}</strong>&rdquo; non è corretta:\",\n      img_exact_width_err: \"Larghezza non corrispondente ({{image_dimension}}px invece di {{allowed_dimension}}px)\",\n      img_min_width_err: \"Larghezza inferiore a quella minima consentita ({{image_dimension}}px invece di {{allowed_dimension}}px)\",\n      img_max_width_err: \"Larghezza superiore a quella massima consentita ({{image_dimension}}px invece di {{allowed_dimension}}px)\",\n      img_exact_height_err: \"Altezza non corrispondente ({{image_dimension}}px invece di {{allowed_dimension}}px)\",\n      img_min_height_err: \"Altezza inferiore a quella minima consentita ({{image_dimension}}px invece di {{allowed_dimension}}px)\",\n      img_max_height_err: \"Altezza superiore a quella massima consentita ({{image_dimension}}px invece di {{allowed_dimension}}px)\"\n    },\n\n    // Url dello script lato server che esegue il caricamento del file\n    // per l'istanza in esame. Ha la precedenza sull'impostazione globale\n    // obbligatorio\n    uploader_url: null,\n\n    // Tipologia dei file selezionabili\n    // il valore deve corrispondere ad una delle chievi dell'array `mimetypes`\n    filetype: 'auto',\n\n    /*\n    Stringa di estensioni o mimetypes separati da virgola accettabili per l'uploader\n    corrente in aggiunta o sostituzione di quanto impostato tramite il parametro `filetype`.\n\n    L'eventuale attributo `accept` del campo input contenuto\n    nel contenitore uploader (se presente), svolge la stessa funzione.\n\n    In entrambi i casi, i valori sono presi in considerazione solo se `filetype == 'auto'`\n\n    In presenza sia del parametro che dell'attributo `accept`, viene effettuato un merge,\n    e l'attributo ha la precedenza sul parametro.\n    Se il parametro &egrave; `null` e l'attributo `accept` non &egrave; presente,\n    con `filetype == auto` vengono accettati tutti i tipi di file.\n    */\n    accept: null,\n\n    /*\n    Parametro multiple.\n    Attiva la possibilit&agrave; di acquisire pi&ugrave; file con lo stesso uploader.\n    L'attivazione di questa opzione pu&ograve; essere effettuata anche tramite il parametro\n    del campo `input` /se presente)\n    */\n    multiple: false,\n\n    /*\n    Parametro required.\n    Eventuale impostazione del campo come obbligatorio.\n    L'attivazione di questa opzione pu&ograve; essere effettuata anche tramite il parametro\n    del campo `input` /se presente)\n    */\n    required: false,\n\n    /*\n    Disabilita (se presente) il form in cui &egrave; incluso l'uploader (disabilita anche iul pulsante submit)\n    da usare solo se nel form non sono presenti altri interazioni che potrebbero\n    entrare in collisione con questa opzione\n    */\n    disable_submit: false,\n\n    /*\n      Template dei markup utilizzati\n      - `main`         : markup principale inserito dentro l'elemento indicato da\n                         `upl.global_options.selector`. L'elemento, a cui viene inoltre\n                         aggiunta la classe `flup`, viene inoltre racchiuso in un elemento\n                         `div.flup-wrapper`\n\n      - `single_img`   : template aggiuntivo per immagini singole\n      - `multiple_imgs`: template aggiuntivo per immagini multiple\n      - `single_doc`   : template aggiuntivo per documenti singoli\n      - `multiple_docs`: template aggiuntivo per documenti multipli\n      - `no_file`      : template per indicare l'assenza di file\n\n      Consulta il readme per ulteriori dettagli.\n\n      Il markup di default utilizza classi di Boostrap 4.\n\n      L'eventuale contenuto dell'elemento originale viene eliminato (pu&ograve; contenere\n      un elemento type[file] per eventuale procedura di fallback)\n\n      I template possono essere alterati a piacimento, purch&eacute; si mantengano le classi\n      `fupl-*` utilizzate nella procedura.\n\n      I template delle immagini, devono contenere il tag img\n\n      doc e img multipli possono essere null, in questo caso vengono utilizzati\n      gli stessi markup per singolo file\n    */\n    templates: {\n      // wrapped in <div class=\"fupl-wrapper\"><div class=\"fupl\"></div></div>\n      main: '<div class=\"fupl-result\"></div>' +\n        '<div class=\"fupl-panel\">' +\n          '<div class=\"fupl-button\">' +\n            '<label><input type=\"file\"></label>' +\n            '<div class=\"fupl-dd-text\">{</div>' +\n          '</div>' +\n          '<div class=\"fupl-info-text\"></div>' +\n        '</div>',\n\n      // contenuto di fupl-result quando non sono presenti files\n      no_file: {\n        img: '<div class=\"fupl-result-empty text-muted small font-italic\">Nessuna immagine presente</div>',\n        doc: '<div class=\"fupl-result-empty text-muted small font-italic\">Nessun file presente</div>'\n      },\n\n      // trigger per la rimozione di un elemento da .fupl_results\n      // è aggiunto all'interno dell'elemento `.fupl-remove`, presente in ognuno\n      // degli elementi successivi\n      // Deve essere un elemento button\n      remove_btn: '<button type=\"button\" class=\"close fupl-remove-trigger\" aria-label=\"Elimina\" title=\"Elimina questo file\">' +\n            '<span aria-hidden=\"true\">&times;</span>' +\n          '</button>',\n\n      // markup aggiunto agli elementi in fase di caricamento\n      loading_element: '<div class=\"fupl-loading\"><progress class=\"fupl-progress\" max=100 value=0></progress></div>',\n\n      // feedback di caricamento alternativo se progress.lengthComputable == false\n      // se necessario e se la funzione `alternate_loading_func` non è presente,\n      // sostituisce l'elemento `.fupl-progress`\n      alternate_loading_progress: '<div class=\"spinner-grow text-primary\" role=\"status\">' +\n          '<span class=\"sr-only\">Loading...</span></div',\n\n      img: {\n        single: '<div class=\"fupl-item\">' +\n          '<div class=\"fupl-remove\"></div>' +\n          '<img alt=\"Immagine caricata\" class=\"img-fluid fupl-img\">' +\n          '<div class=\"fupl-file-info\">' +\n            '<div class=\"text-truncate fupl-file-name\"></div>' +\n            '<div class=\"fupl-file-size\"></div>' +\n          '</div>' +\n        '</div>',\n\n        multiple: '<div class=\"fupl-item\">' +\n            '<div class=\"fupl-remove\"></div>' +\n            '<div class=\"fupl-img-wrapper\">' +\n              '<img alt=\"Immagine caricata\" class=\"img-fluid fupl-img\">' +\n            '</div>' +\n            '<div class=\"fupl-file-info\">' +\n              '<div class=\"text-truncate fupl-file-name\"></div>' +\n              '<div class=\"fupl-file-size\"></div>' +\n            '</div>' +\n          '</div>'\n      },\n\n      doc : {\n        single: '<div class=\"fupl-item\">' +\n            '<div class=\"fupl-remove\"></div>' +\n            '<div class=\"fupl-doc text-truncate\">' +\n              '<a href=\"#\" class=\"text-truncate fupl-file-name fupl-url\"></a>' +\n            '</div>' +\n            '<span class=\"small ml-1 text-nowrap fupl-file-size\"></span>' +\n          '</div>',\n\n        multiple: null // usa single_doc\n      }\n    },\n\n    // Eventuale classi da aggiungere all'elemento wrapper di FileUploader\n    // (stringa separata da spazi)\n    wrapper_extra_class: null,\n\n    // Classe da aggiungere all'elemento FileUploader quando un file\n    // vi è trascinato sopra\n    element_dragover_class: 'fupl-is-dragover',\n\n    // Opzione per l'aggiunta di un tag legend prima dell'elemento uploader\n    uploader_legend: true,\n\n    // tetso dell'elemento legend da applicare da applicare all'elemento FileUploader.\n    // Se `null` e se esiste un elemento `label` all'interno dell'uploader,\n    // viene preso il testo dell'elemento\n    uploader_legend_text: null,\n\n    // Eventuale classe da aggiungere ad uploader_legend\n    uploader_legend_class: null,\n\n    /*\n    Array (o stringa json) dei testi del label del tag input (il primo elemento dell'array) e del testo\n    informativo per il drag &drop da inserire in `.fupl-dd-text` (il secondo elemento)\n    nelle varie combinazioni (img singola e multiple, doc singole e multipli)\n    segnaposti: ['{{input_label}}', '{{dd_text}}']\n    */\n    input_text: {\n      img: {\n        single:   [\"Seleziona un'immagine\", \"\\u2026oppure trascinala qui\"],\n        multiple: [\"Seleziona una o pi&ugrave; immagini\", \"\\u2026oppure trascinale qui\"]\n      },\n      doc: {\n        single: [\"Seleziona un documento\", \"\\u2026oppure trascinalo qui\"],\n        multiple: [\"Seleziona uno o pi&ugrave; documenti\", \"\\u2026oppure trascinali qui\"]\n      }\n    },\n\n    // classi da applicare al tag label dell'input[file] generato, utilizzato\n    // come pulsante per la selezione dei file\n    input_label_class: 'btn btn-outline-primary btn-sm',\n\n    // indica se mostrare o no il testo informativo su formati accettati,\n    // dimensioni immagini, ecc. Se si decide di non mostrarlo, potrebbe essere\n    // necessario rimuovere dal template l'elemento `.fupl-info-text`\n    show_info_text: true,\n\n    // stringhe aggiunte all'inizio e alla fine del testo informativo generato\n    // utilizzate solo se `custom_info_text` non &egrave; impostato\n    info_text_wrap_string: ['(', ')'],\n\n    // Stringa utilizzata per concatenare tra loro le varie parti del testo informativo generato\n    // utilizzata solo se `custom_info_text` non &egrave; impostato\n    info_text_join_string: ', ',\n\n    // Eventuale testo informativo personalizzato. se presente,\n    // sostituisce il testo generato in base ai formati, ai limiti di dimensioni, ecc.\n    custom_info_text: null,\n\n    /*\n    impostazioni per le immagini.\n    Applicate solo se filetype == 'img'.\n    Valori numerici che corrispondono alle dimensioni in pixel richieste per l'immagine.\n    I parametri img_min_* e img_max_* possono essere assegnati simultaneamente,\n    ma sono ignorati se esistono i corrispondenti parametri esatti (ad esempio,\n    se &egrave; presente img_w, i parametri img_min_w e img_max_w non vengono presi in considerazione).\n    Il valore di default di tutti i parametri &egrave; null, che significa che non vengono applicati.\n\n      * `img_min_w`: larghezza minima dell'immagine\n      * `img_max_w`: larghezza massima dell'immagine\n      * `img_w`: larghezza esatta dell'immagine\n      * `img_min_h`: altezza minima dell'immagine\n      * `img_max_h`: altezza massima dell'immagine\n      * `img_h`: altezza esatta dell'immagine\n    */\n    img_min_w   : null,\n    img_max_w   : null,\n    img_w       : null,\n    img_min_h   : null,\n    img_max_h   : null,\n    img_h       : null,\n\n\n    /*\n    Dimensione (peso) massima dell'immagine. Pu&ograve; essere un numero,\n    e in questo caso corrisponde ad una dimensione in KB, o una stringa\n    composta da un valore numerico e da un suffisso tra ‘KB’ e ‘MB’ (anche minuscoli).\n    Se il valore &egrave; null o se la stringa non viene riconosciuta,\n    non &egrave; applicato nessun limite.\n    */\n    max_filesize: null,\n\n    // Prefisso della variabile utilizzata per inviare al server i dati\n    // di ogni singolo file caricato. Il valore indicato &egrave; il nome base dell'array\n    // costruito per inviare i valori al server.\n    varname: 'file',\n\n    // Funzione richiamata dopo l'inizializzazione di ogni elemento FileUploader.\n    // La funzione viene invocata con l'oggetto di tutte le opzioni come argomento\n    init_callback: null,\n\n    /*\n    Funzione richiamata ogni volta che un file viene inviato al server.\n    La funzione viene invocata passandole un oggetto contenente:\n      * `item`: oggetto con i dati dell'elemento in esame:\n        - id: id univoco dell'elemento\n        - file: oggetto filelist corrente\n        - `width` e `height`: null o dimensioni in pixel dell'immagine\n        - `tmp_file`: nel caso di nuovi elementi: nome del file temporaneo\n      * `img_preview` : miniatura dell'immagine in forma di stringa Base64\n        (null se si tratta di altre tipologie)\n      * `fupl_options`: oggetto `options` corrente\n    */\n    upload_start_callback: null,\n\n    /*\n    Funzione richiamata ogni volta che un file viene caricato.\n    La funzione viene invocata passandole un oggetto contenente:\n      * `item`: oggetto con i dati dell'elemento in esame:\n        - `id`: id univoco dell'elemento\n        - `file`: oggetto filelist\n        - `width` e `height`: null o dimensioni in pixel dell'immagine\n        - `tmp_file`: nel caso di nuovi elementi: nome del file temporaneo\n      * `server_error`: null, se l'upload &egrave; stato completato correttamente. oppure\n          stringa con il messaggio di errore restituito\n      * `fupl_options`: oggetto `options` corrente\n    */\n    upload_complete_callback: null,\n\n    /*\n      Funzione di visulizzazione alternativa del progresso di caricamento\n      Se presente, viene sostituita a quella standard.\n      Viene invocata con due parametri:\n        - `progress_event`: evento progress del caricamento\n        - `fupl_options`: oggetto `options` corrente\n    */\n    alternate_loading_func: null,\n\n    /*\n    Array json degli eventuali elementi preregistrati, nella forma:\n      [\n        {\n          rel_id → eventuale id del record relazionato al file (può essere null o assente)\n                   se esiste, viene utilizzato al posto di `id` per indicare il record da cancellare\n          id     → identificativo univoco del file (può essere anche il percorso sul server)\n          name   → nome del file\n          url    → url per eventuale tag <a> presente nell'elemento (se immagine può essere assente o null)\n          src    → attributo `src` obbligatorio se immagine, oppure assente o null\n          wi     → larghezza in px se immagine oppure assente o null\n          he     → altezza in px se immagine oppure assente o null\n          size   → dimensione in bytes\n          [...]  → eventuali campi aggiuntivi specifici dell'istanza\n        }\n        [...]\n      ]\n\n      l'id viene aggiunto come attributo `data` al pulsante di eliminazione del file\n      (genera un hidden con l'id del file da eliminare dal server)\n    */\n    values: [],\n\n    // varname degli hidden con gli id dei file gi&agrave; registrati  da eliminare\n    delete_varname: 'elimina_file[]',\n\n// TODO\n    // attiva la possibilit&agrave; di riordinare gli elementi trascinandoli\n    // se true, i valori degli eventuali elementi preregistrati devono essere\n    // elencati nel josn `values` nell'ordine correttp\n    reorder: false,\n\n    // name della variabile hidden usata per registrare l'ordinamento\n    reorder_varname: 'order'\n\n// TODO gestione campi aggiuntivi\n  };\n\n  upl.setOptions = (...custom_options) => {\n\n    if( Object.assign && typeof Object.assign === \"function\") {\n      return Object.assign(\n        {},\n        default_options,\n        ...custom_options\n      );\n\n    } else { // IE 11, necessario anche se non c'è il supporto IE\n      let opts = {};\n      for(let i in default_options) {\n        opts[i] = default_options[i];\n        custom_options.forEach( item => {\n          if(item[i] !== undefined) {\n            opts[i] = item[i];\n          }\n        });\n      }\n      return opts;\n    }\n  };\n\n  return upl;\n\n})(FileUploader2 || {});\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n\n  // mimetypes ed estensioni accettabili in base al parametro `filetype`.\n  // Il parametro `auto` accetta tutti i tipi di file (salvo eventuali limitazioni\n  // aggiunte tramite parametro e attributo `accept`)\n  upl.mimetypes = {\n    auto : null,\n    img  : ['image/png', 'image/jpeg', 'image/pjpeg', 'image/gif', 'image/webp',\n            '.png', '.jpg', '.jpeg', '.pjpg', '.pjpeg', '.gif', '.webp'],\n    pdf  : ['application/pdf', '.pdf']\n  };\n\n  // nomi degli attributi data utilizzati per controllare alcuni stati o eventi dell'uploader\n  upl.data_attributes = {\n    fupl_selector : 'file_uploader2', // nome dell'attributo data usato come selector (e acui si possonoa ssociare delle opzioni json)\n    required      : 'required', // true se il caricamento del file è obbligatorio\n    hasValues     : 'hasValues', // true se l'uploader congtiene dei file (prergistrati o meno)\n    item_id       : 'id' // id dell'elemento aggiunto all'uploader (se preregistrato)\n  };\n\n  upl.set_has_values = fupl_options => {\n    let items = fupl_options.istance_result_wrapper.querySelectorAll('.fupl-item').length;\n    fupl_options.wrapper.dataset[upl.data_attributes.hasValues] = items? 'true' : 'false';\n    if(!items) {\n      fupl_options.istance_result_wrapper.innerHTML = fupl_options.templates.no_file[fupl_options._type];\n    }\n  };\n\n\n  upl.parse_filesize = (bytes, locales) => {\n    bytes = +bytes;\n    let mega = 1024*1024;\n    if(bytes >= mega ) {\n      return (bytes/mega).toLocaleString(locales, {maximumFractionDigits: 1}) + '<span class=\"fupl-unit\">MB</span>';\n    } else {\n      return Math.round(bytes/1024).toLocaleString(locales, {maximumFractionDigits: 0}) + '<span class=\"fupl-unit\">KB</span>';\n    }\n  };\n\n\n  /*\n   parse_max_filesize\n   elabora il parametro `filesize_value` (se esiste) e restituisce:\n    - `null` se `filesize_value` === null`\n    - `false` se `filesize_value` non è un valore corretto\n    - l'oggetto `{ maxbytes: 123456, unit: 'KB', feedback_size: ''}`\n    in cui:\n      - `maxbytes` è il valore in bytes del limite imposto\n      - `unit` è uno tra 'KB' e 'MB'\n      - `feedback_size` è la rappresentazione per un eventuale feedback per l'utente\n  */\n  upl.parse_max_filesize = (filesize_value, locales) =>  {\n    // controllo max_filesize ed elaborazione parametro\n    if( filesize_value ) {\n      var maxbytes, unit, feedback_size;\n\n      if(!isNaN(filesize_value)) { //solo numero, si assume siano KB\n        maxbytes = +filesize_value;\n        unit = 'KB';\n        feedback_size = maxbytes;\n\n      } else {\n\n        unit = filesize_value.substr(-2, 2).toUpperCase();\n        maxbytes = +filesize_value.substr(0, filesize_value.length-2);\n        feedback_size = maxbytes;\n\n        if(isNaN(maxbytes) || (unit !== 'KB' && unit !== 'MB') ) {\n          return false;\n        }\n      }\n\n      // se l'unità è indicata in KB ma il valore è più grande\n      // di un MB, il parametro viene aggiornato\n      if( maxbytes >= 1024 && unit === 'KB') {\n        unit = 'MB';\n        feedback_size = (Math.round((maxbytes / 1024) * 100) /100);\n      }\n\n      if(unit === 'KB') {\n        maxbytes = maxbytes * 1024;\n      } else {\n        maxbytes = maxbytes * 1024 * 1024;\n      }\n\n      return {\n        //'original_value': filesize_value,\n        //'unit'         : unit,\n        'maxbytes'     : maxbytes,\n        'feedback_size': feedback_size.toLocaleString(\n          locales, {maximumFractionDigits: (unit === 'KB'? 0 : 1)}\n        ) + '<span class=\"fupl-unit\">' + unit + '</span>'\n      };\n\n    } else {\n      return null;\n    }\n  };\n\n  return upl;\n\n})(FileUploader2 || {});\n"]}