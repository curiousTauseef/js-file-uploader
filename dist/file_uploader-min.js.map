{"version":3,"sources":["../js/file_uploader.js","../js/_init.js","../js/_create_uploader.js","../js/_set_options.js"],"names":["FileUploader2","upl","mimetypes","auto","img","pdf","fupl_selector_data_name","isSuitableBrowser","div","document","createElement","window","parse_max_filesize","filesize_value","locales","maxbytes","unit","feedback_size","isNaN","substr","toUpperCase","length","Math","round","toLocaleString","init","user_global_options","global_options","setOptions","css","head","insertAdjacentHTML","querySelectorAll","forEach","upl_element","upl_element_options","dataset","JSON","parse","element","_input","querySelector","url","Error","filetype","toLowerCase","Object","keys","indexOf","accept_attr","accept_params","accept","split","map","item","trim","getAttribute","_toConsumableArray","Set","concat","max_filesize","multiple","Boolean","hasAttribute","required","e","console","error","createUploader","alert","unsuitableBrowserMessage","fupl_options","upl_istance","_type","_mode","original_label","uploader_label_text","innerHTML","classList","add","wrapper","_fupl_options$element","_upl_istance$label$cl","parentNode","insertBefore","appendChild","element_class","apply","uploader_add_label","_class","uploader_label_class","push","join","templates","main","assign","input","label","dd_text","info_text","result_wrapper","setAttribute","input_text","input_label_class","init_callback","debug","groupCollapsed","c_options","c_keys","sort","_toStringify","_typeof","stringify","log","table","groupEnd","default_options","alert_api","mes","no_file","remove_btn","single_img","multiple_imgs","single_doc","multiple_docs","no_img_text","no_doc_text","element_dragover_class","single","doc","show_info_text","info_text_wrap_string","info_text_join_string","custom_info_text","img_min_w","img_max_w","img_w","img_min_h","img_max_h","img_h","varname","upload_start_callback","upload_complete_callback","values","_len","arguments","custom_options","Array","_key","_ret","opts","_loop","i","undefined","v"],"mappings":";;;;;;;GAmBA,IAAIA,cAAiB,WAEnB,IAAIC,EAEJ,MAFU,GAFS,+4CCjBrBD,cAAiB,SAACC,GAOhB,IAAMC,EAAY,CAChBC,KAAO,KACPC,IAAO,CAAC,YAAa,aAAc,cAAe,YAAa,aACvD,OAAQ,OAAQ,QAAS,QAAS,SAAU,OAAQ,SAC5DC,IAAO,CAAC,kBAAmB,SAI7BC,EAA0B,iBAO1BC,EAAoB,SAApBA,IACE,IAAIC,EAAMC,SAASC,cAAe,OAClC,OAAW,cAAeF,GAAW,gBAAiBA,GAAO,WAAYA,IACpE,aAAcG,QACd,eAAgBA,QAcvBC,EAAqB,SAArBA,EAAsBC,EAAgBC,GAEpC,GAAID,EAAiB,CACnB,IAAIE,EAAUC,EAAMC,EAEpB,GAAIC,MAAML,IAWR,GAJAG,EAAOH,EAAeM,QAAQ,EAAG,GAAGC,cAEpCH,EADAF,GAAYF,EAAeM,OAAO,EAAGN,EAAeQ,OAAO,GAGxDH,MAAMH,IAAuB,OAATC,GAA0B,OAATA,EACtC,OAAO,OAXTD,GAAYF,EACZG,EAAO,KACPC,EAAgBJ,EA0BlB,OAXIE,GAAY,MAAiB,OAATC,IACtBA,EAAO,KACPC,EAAiBK,KAAKC,MAAOR,EAAW,KAAQ,KAAM,KAG5C,OAATC,EACDD,GAAsB,KAEtBA,EAAsB,KAAXA,EAAkB,KAGxB,CAGLA,SAAiBA,EACjBE,cAAiBA,EAAcO,eAAeV,GAAW,SAAWE,GAItE,OAAO,MAgIX,OAxHAf,EAAIwB,KAAO,SAACC,GAEV,IAAMC,EAAiB1B,EAAI2B,WAAWF,GAGjCnB,KAMFoB,EAAeE,KAChBpB,SAASqB,KAAKC,mBAAmB,YAC/B,gCAAkCJ,EAAeE,IAAM,kCAK3DpB,SAASuB,iBAAiB,yBAA0CC,QAAS,SAAAC,GAe3E,IAAIC,EAAsBD,EAAYE,QAAZ,eAGxBD,EADyB,KAAxBA,EACqB,GAEAE,KAAKC,MAAMH,UAGnCA,EAAsBlC,EAAI2B,WACxB,GACAD,EACAO,EAAYE,QACZD,IAIwB,eAG1BA,EAAoBI,QAAUL,EAG9B,IAGE,IAAIM,EAASN,EAAYO,cAAc,sBAGvC,IAAKN,EAAoBO,IACvB,MAAM,IAAIC,MAAO,iCAKnB,GADAR,EAAoBS,SAAWT,EAAoBS,SAASC,eACU,IAAlEC,OAAOC,KAAK7C,GAAW8C,QAAQb,EAAoBS,UAErD,MAAM,IAAID,MAAO,qCAGjB,GAAqC,SAAjCR,EAAoBS,SAAsB,CAE5C,IAAIK,EAAc,GAClBC,EAAgB,GAEmB,OAA/Bf,EAAoBgB,SACtBD,EAAgBf,EAAoBgB,OACjCC,MAAM,KAAKC,IAAK,SAAAC,GAAI,OAAIA,EAAKC,UAG/Bf,GAAUA,EAAOgB,aAAa,YAC/BP,EAAcT,EAAOgB,aAAa,UAC/BJ,MAAM,KAAKC,IAAK,SAAAC,GAAI,OAAIA,EAAKC,UAIlCpB,EAAoBgB,OAApBM,mBAAiC,IAAIC,IAAJ,GAAAC,OAAAF,mBAAYP,GAAZO,mBAA8BR,WAG/Dd,EAAoBgB,OAASjD,EAAUiC,EAAoBS,UAI7D,IAAIgB,EAAehD,EAAmBuB,EAAoByB,aAAczB,EAAoBrB,SAC5F,IAAqB,IAAjB8C,EACF,MAAM,IAAIjB,MAAO,IAAMR,EAAoByB,aAAe,iDAE1DzB,EAAoByB,aAAeA,EAIrCzB,EAAoB0B,SAAWC,QAAQ3B,EAAoB0B,UACxDrB,GAAUA,EAAOuB,aAAa,aAGjC5B,EAAoB6B,SAAWF,QAAQ3B,EAAoB6B,UACxDxB,GAAUA,EAAOuB,aAAa,aAGnC,MAAME,GACNC,QAAQC,MAAOF,GAGjB,IAAIhE,EAAImE,eAAejC,MA7GvBkC,MAAM1C,EAAe2C,2BAkHlBrE,EAlNQ,ECAjBD,cAAiB,SAACC,GA+HhB,OA7HAA,EAAImE,eAAiB,SAACG,GAGpB,IAAIC,EAAc,CAChBC,MAAiC,QAA1BF,EAAa3B,SAAoB,MAAQ,MAChD8B,MAAOH,EAAaV,SAAU,SAAW,YAG3Cc,EAAiBJ,EAAahC,QAAQE,cAAc,UAG/C8B,EAAaK,qBAAuBD,IACvCJ,EAAaK,oBAAsBD,EAAeE,WAG9CN,EAAaK,sBACjBL,EAAaK,oBAAsB,0BAIrCL,EAAahC,QAAQuC,UAAUC,IAAI,QAGnC,IAAIC,EAAUvE,SAASC,cAAc,OASJuE,EA4CEC,GApDnCX,EAAahC,QAAQ4C,WAAWC,aAAaJ,EAAST,EAAahC,SACnEyC,EAAQK,YAAYd,EAAahC,SACjCyC,EAAQF,UAAUC,IAAI,gBACtBC,EAAQF,UAAUC,IAAI,aAAeP,EAAYC,OAC9CF,EAAaV,UACdmB,EAAQF,UAAUC,IAAI,iBAGpBR,EAAae,iBACfL,EAAAV,EAAahC,QAAQuC,WAAUC,IAA/BQ,MAAAN,EAAAxB,mBAAuCc,EAAae,cAAclC,MAAM,OAI1E,GAAImB,EAAaiB,mBAAqB,CACpC,IAAIC,EAAS,CAAC,cACVlB,EAAamB,sBACfD,EAAOE,KAAKpB,EAAamB,sBAEvBnB,EAAaP,UACfyB,EAAOE,KAAK,YAEdpB,EAAahC,QAAQR,mBAAmB,cACtC,kCACc0D,EAAOpE,OAAQ,WAAaoE,EAAOG,KAAK,KAAO,IAAM,IAAM,IACrErB,EAAaK,oBACf,kBAGJI,EAAQF,UAAUC,IAAK,mBAIzBR,EAAahC,QAAQsC,UAAYN,EAAasB,UAAUC,KAExDtB,EAAc1B,OAAOiD,OAAOvB,EAAa,CACvCwB,MAAOzB,EAAahC,QAAQE,cAAc,kCAC1CwD,MAAO1B,EAAahC,QAAQE,cAAc,qBAC1CyD,QAAS3B,EAAahC,QAAQE,cAAc,6BAC5C0D,UAAW5B,EAAahC,QAAQE,cAAc,+BAC9C2D,eAAgB7B,EAAahC,QAAQE,cAAc,kBAIjD8B,EAAaP,UACfQ,EAAYwB,MAAMK,aAAa,WAAY,IAEzC9B,EAAaV,UACfW,EAAYwB,MAAMK,aAAa,WAAY,IAE7C7B,EAAYyB,MAAMlE,mBAAmB,YACnCwC,EAAa+B,WAAW9B,EAAYC,OAAOD,EAAYE,OAAO,IAE7DH,EAAagC,qBACdrB,EAAAV,EAAYyB,MAAMnB,WAAUC,IAA5BQ,MAAAL,EAAAzB,mBAAmCc,EAAagC,kBAAkBnD,MAAM,OAiB1E,GAfAoB,EAAY0B,QAAQrB,UAAYN,EAAa+B,WAAW9B,EAAYC,OAAOD,EAAYE,OAAO,GAG9FF,EAAY2B,UAAUtB,UAAY,MAMC,OAA/BN,EAAaiC,eACfjC,EAAaiC,cAAejC,GAK1BA,EAAakC,MAAQ,CAEvBvC,QAAQwC,eAAe,wBAGvB,IAAIC,EAAY,GAChBC,EAAS9D,OAAOC,KAAKwB,GACrBqC,EAAOC,OACPD,EAAO3E,QAAQ,SAAAqB,GACb,IAAIwD,EAA6C,WAA9BC,QAAOxC,EAAajB,KAChB,OAAvBiB,EAAajB,IACF,YAATA,EACFqD,EAAUrD,GAAQwD,EAAezE,KAAK2E,UAAUzC,EAAajB,GAAO,KAAM,KAAOiB,EAAajB,KAEhGY,QAAQ+C,IAAI,gBACZ/C,QAAQgD,MAAMP,GACdzC,QAAQ+C,IAAI,eACZ/C,QAAQgD,MAAM1C,GACdN,QAAQwC,eAAe,gBACrBxC,QAAQ+C,IAAI1C,GACdL,QAAQiD,WACRjD,QAAQwC,eAAe,eACrBxC,QAAQ+C,IAAIzC,GACdN,QAAQiD,WACRjD,QAAQiD,aAOLlH,EA/HQ,ECAjBD,cAAkB,SAACC,GAIjB,IAAMmH,EAAkB,CAGtBvF,IAAK,KAIL4E,OAAO,EAIP3F,QAAS,QAGTwD,yBAA0B,wEAG1B+C,UAAW,SAAAA,EAACC,GAAU3G,OAAO0D,MAAMiD,IAKnC5E,IAAK,KAILE,SAAU,OAgBVO,OAAQ,KAQRU,UAAU,EAQVG,UAAU,EA4BV6B,UAAW,CAETC,KAAM,oMAUNyB,QAAS,qEAMTC,WAAY,wIAIZC,WAAY,mOASZC,cAAe,+PAWfC,WAAY,0NAQZC,cAAe,MAIjBC,YAAa,4BAIbC,YAAa,uBAIbxC,cAAe,KAIfyC,uBAAwB,mBAKxBnD,oBAAqB,KAGrBY,oBAAoB,EAGpBE,qBAAsB,KAQtBY,WAAY,CACVlG,IAAK,CACH4H,OAAU,CAAC,wBAAyB,0BACpCnE,SAAU,CAAC,+BAAgC,2BAE7CoE,IAAK,CACHD,OAAQ,CAAC,yBAA0B,0BACnCnE,SAAU,CAAC,gCAAiC,4BAMhD0C,kBAAmB,iCAKnB2B,gBAAgB,EAIhBC,sBAAuB,CAAC,IAAK,KAI7BC,sBAAuB,KAIvBC,iBAAkB,KAkBlBC,UAAc,KACdC,UAAc,KACdC,MAAc,KACdC,UAAc,KACdC,UAAc,KACdC,MAAc,KASd/E,aAAc,KAKdgF,QAAS,OAITpC,cAAe,KAafqC,sBAAuB,KAcvBC,yBAA0B,KAW1BC,OAAQ,IA0BV,OAvBA9I,EAAI2B,WAAa,WAAuB,IAAA,IAAAoH,EAAAC,UAAA5H,OAAnB6H,EAAmB,IAAAC,MAAAH,GAAAI,EAAA,EAAAA,EAAAJ,EAAAI,IAAnBF,EAAmBE,GAAAH,UAAAG,GAEtC,GAA6B,mBAAlBtG,OAAOiD,OAChB,OAAOjD,OAAOiD,OAAPR,MAAAzC,OAAM,CACX,GACAsE,GAFWzD,OAGRuF,IAGA,IAAAG,EAAA,WACL,IAAIC,EAAO,GADNC,EAAA,SAAAA,EAEGC,GACNF,EAAKE,GAAKpC,EAAgBoC,GAC1BN,EAAejH,QAAS,SAAAqB,QACPmG,IAAZnG,EAAKkG,KACNF,EAAKE,GAAKlG,EAAKkG,OAJrB,IAAI,IAAIA,KAAKpC,EAAiBmC,EAAtBC,GAQR,MAAA,CAAAE,EAAOJ,GAVF,GAAA,MAAA,WAAAvC,QAAAsC,GAAAA,EAAAK,OAAA,GAcFzJ,EAtTS,CAwTfD,eAAiB,MDvLA,MDmFA","sourcesContent":["/*!@preserve\n *\n * FileUploader 2.0\n * HTML5 / JS Async Uploader\n * Massimo Cassandro 2017-2019\n *\n */\n\n/* eslint no-console: 0, no-unused-vars: 0, no-empty:  0 */\n/* exported FileUploader2 */\n\n/*\n@codekit-append '_set_options.js'\n@codekit-append '_create_uploader.js'\n\n@codekit-append '_init.js'\n\n*/\n\nvar FileUploader2 = (() => {\n  \"use strict\";\n  let upl = {};\n\n  return upl;\n})();\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n\n  // VARIABILI E METODI PRIVATI\n\n  // mimetypes ed estensioni accettabili in base al parametro `filetype`.\n  // Il parametro `auto` accetta tutti i tipi di file (salvo eventuali limitazioni\n  // aggiunte tramite parametro e attributo `accept`)\n  const mimetypes = {\n    auto : null,\n    img  : ['image/png', 'image/jpeg', 'image/pjpeg', 'image/gif', 'image/webp',\n            '.png', '.jpg', '.jpeg', '.pjpg', '.pjpeg', '.gif', '.webp'],\n    pdf  : ['application/pdf', '.pdf']\n  },\n\n  // nome dell'attributo data da usare come selettore degli elementi su cui applicare FileUploader.\n  fupl_selector_data_name = 'file_uploader2',\n\n  /*\n    isSuitableBrowser\n    Verifica che il browser sia in grado di gestire le funzionalità richieste.\n    Restituisce `true` o `false`\n  */\n  isSuitableBrowser = () => {\n    var div = document.createElement( 'div' );\n    return ( ( 'draggable' in div ) || ( 'ondragstart' in div && 'ondrop' in div ) )\n      && 'FormData' in window\n      && 'FileReader' in window;\n  },\n\n  /*\n   parse_max_filesize\n   elabora il parametro `filesize_value` (se esiste) e restituisce:\n    - `null` se `filesize_value` === null`\n    - `false` se `filesize_value` non è un valore corretto\n    - l'oggetto `{ maxbytes: 123456, unit: 'KB', feedback_size: ''}`\n    in cui:\n      - `maxbytes` è il valore in bytes del limite imposto\n      - `unit` è uno tra 'KB' e 'MB'\n      - `feedback_size` è la rappresentazione per un eventuale feedback per l'utente\n  */\n  parse_max_filesize = (filesize_value, locales) =>  {\n    // controllo max_filesize ed elaborazione parametro\n    if( filesize_value ) {\n      var maxbytes, unit, feedback_size;\n\n      if(!isNaN(filesize_value)) { //solo numero, si assume siano KB\n        maxbytes = +filesize_value;\n        unit = 'KB';\n        feedback_size = filesize_value;\n\n      } else {\n\n        unit = filesize_value.substr(-2, 2).toUpperCase();\n        maxbytes = +filesize_value.substr(0, filesize_value.length-2);\n        feedback_size = maxbytes;\n\n        if(isNaN(maxbytes) || (unit !== 'KB' && unit !== 'MB') ) {\n          return false;\n        }\n      }\n\n      // se l'unità è indicata in KB ma il valore è più grande\n      // di un MB, il parametro viene aggiornato\n      if( maxbytes >= 1024 && unit === 'KB') {\n        unit = 'MB';\n        feedback_size = (Math.round((maxbytes / 1024) * 100) /100);\n      }\n\n      if(unit === 'KB') {\n        maxbytes = maxbytes * 1024;\n      } else {\n        maxbytes = maxbytes * 1024 * 1024;\n      }\n\n      return {\n        //'original_value': filesize_value,\n        //'unit'         : unit,\n        'maxbytes'     : maxbytes,\n        'feedback_size': feedback_size.toLocaleString(locales) + '&nbsp;' + unit\n      };\n\n    } else {\n      return null;\n    }\n  };\n\n  /*\n    init\n    Seleziona gli elementi con l'attributo `fupl_selector` e avvia FileUploader\n  */\n  upl.init = (user_global_options) => {\n\n    const global_options = upl.setOptions(user_global_options);\n\n    // verifica che il browser sia compatibile\n    if( !isSuitableBrowser() ) {\n      alert(global_options.unsuitableBrowserMessage);\n      return;\n    }\n\n    // caricamento CSS\n    if(global_options.css) {\n      document.head.insertAdjacentHTML('beforeend',\n        '<link rel=\"stylesheet\" href=\"' + global_options.css + '\" type=\"text/css\" media=\"all\">'\n      );\n    }\n\n    // istanze uploader\n    document.querySelectorAll('[data-' + fupl_selector_data_name + ']').forEach( upl_element => {\n\n      /*\n        merge dei parametri inseriti tramite attributi `data`, in cui:\n\n        * `upl_element.dataset`:\n            tutti gli attributi inseriti singolarmente (es. data-filetype=\"img\")\n\n        * `upl_element.dataset[fupl_selector_data_name]`:\n            attributi inseriti tramite json assegnato a `data- + 'fupl_selector_data_name'`\n            (es data-file_uploader2='{\"filetype\":\"img\"}')\n\n        In caso di conflitto prevalgono gli ultimi\n      */\n\n      let upl_element_options = upl_element.dataset[fupl_selector_data_name];\n\n      if(upl_element_options === '') {\n        upl_element_options = {};\n      } else {\n        upl_element_options = JSON.parse(upl_element_options);\n      }\n\n      upl_element_options = upl.setOptions(\n        {},\n        global_options,\n        upl_element.dataset,\n        upl_element_options\n      );\n\n      // cancella la chiave `fupl_selector_data_name` al solo scopo di ridurre la confusione\n      delete upl_element_options[fupl_selector_data_name];\n\n      // aggiunta dell'elemento stesso ad  `istance_options`:\n      upl_element_options.element = upl_element;\n\n      // controllo parametri e avvio uploader\n      try {\n\n        // eventuale campo input\n        let _input = upl_element.querySelector('input[type=\"file\"]');\n\n        //  url\n        if( !upl_element_options.url ) {\n          throw new Error( \"Parametro `url` non impostato\" );\n        }\n\n        //  parametro filetype\n        upl_element_options.filetype = upl_element_options.filetype.toLowerCase();\n        if( Object.keys(mimetypes).indexOf(upl_element_options.filetype) === -1 ) {\n\n          throw new Error( \"Parametro `filetype` non corretto\" );\n        } else {\n          // implementazione eventuali parametro/attributo `accept`\n          if( upl_element_options.filetype === 'auto' ) {\n\n            let accept_attr = [],\n            accept_params = [];\n\n            if( upl_element_options.accept !== null ) {\n              accept_params = upl_element_options.accept\n                .split(',').map( item => item.trim() );\n            }\n\n            if(_input && _input.getAttribute('accept') ) {\n              accept_attr = _input.getAttribute('accept')\n                .split(',').map( item => item.trim() );\n            }\n\n            // https://www.peterbe.com/plog/merge-two-arrays-without-duplicates-in-javascript\n            upl_element_options.accept = [...new Set([...accept_params, ...accept_attr])];\n\n          } else {\n            upl_element_options.accept = mimetypes[upl_element_options.filetype];\n          }\n\n          // elaborazione max_filesize\n          let max_filesize = parse_max_filesize(upl_element_options.max_filesize, upl_element_options.locales);\n          if( max_filesize === false ) {\n            throw new Error( '\"' + upl_element_options.max_filesize + '\" non è un valore corretto per `max_filesize`');\n          } else {\n            upl_element_options.max_filesize = max_filesize;\n          }\n\n          // parametro o attributo multiple\n          upl_element_options.multiple = Boolean(upl_element_options.multiple ||\n            (_input && _input.hasAttribute('multiple') ));\n\n          // parametro o attributo required\n          upl_element_options.required = Boolean(upl_element_options.required ||\n            (_input && _input.hasAttribute('required') ));\n        }\n\n      } catch(e) {\n        console.error( e );// eslint-disable-line\n      }\n\n      new upl.createUploader(upl_element_options);\n\n     }); // end document.querySelectorAll(fupl_selector).forEach\n  }; // end upl.init\n\n  return upl;\n\n})(FileUploader2 || {});\n\n","/* globals FileUploader2:true */\n\nFileUploader2 = ((upl) => {\n\n  upl.createUploader = (fupl_options) => {\n\n    // tipologia generale dell'uploader (img o doc)\n    let upl_istance = {\n      _type: fupl_options.filetype === 'img'? 'img' : 'doc',\n      _mode: fupl_options.multiple? 'single' : 'multiple'\n    },\n    // rilevamento eventuali elemento label\n    original_label = fupl_options.element.querySelector('label');\n\n    // testo label (da tag o parametro uploader_label_text)\n    if( !fupl_options.uploader_label_text && original_label) {\n      fupl_options.uploader_label_text = original_label.innerHTML;\n    }\n    // caso in cui sia presente nessun valore\n    if ( !fupl_options.uploader_label_text ) {\n      fupl_options.uploader_label_text = '__label non presente__';\n    }\n\n    // aggiunta della classe principale\n    fupl_options.element.classList.add(\"fupl\");\n\n    // aggiunta wrapper\n    let wrapper = document.createElement('div');\n    fupl_options.element.parentNode.insertBefore(wrapper, fupl_options.element);\n    wrapper.appendChild(fupl_options.element);\n    wrapper.classList.add(\"fupl-wrapper\");\n    wrapper.classList.add(\"fupl-type-\" + upl_istance._type );\n    if(fupl_options.multiple) {\n      wrapper.classList.add(\"fupl-multiple\");\n    }\n    // aggiunta eventuali class' personale\n    if( fupl_options.element_class ) {\n      fupl_options.element.classList.add( ...fupl_options.element_class.split(' ') );\n    }\n\n    // aggiunta label uplaoder\n    if( fupl_options.uploader_add_label ) {\n      let _class = ['fupl-label'];\n      if( fupl_options.uploader_label_class ) {\n        _class.push(fupl_options.uploader_label_class);\n      }\n      if( fupl_options.required ) {\n        _class.push('required');\n      }\n      fupl_options.element.insertAdjacentHTML('beforebegin',\n        '<div class=\"fupl-label\">' +\n          '<label' + (_class.length? ' class=\"' + _class.join(' ') + '\"' : '') + '>' +\n            fupl_options.uploader_label_text +\n          '</label>' +\n        '</div>'\n      );\n      wrapper.classList.add( 'fupl-has-label' );\n    }\n\n    // aggiunta template uploader\n    fupl_options.element.innerHTML = fupl_options.templates.main;\n\n    upl_istance = Object.assign(upl_istance, {\n      input: fupl_options.element.querySelector('.fupl-panel input[type=\"file\"]'),\n      label: fupl_options.element.querySelector('.fupl-panel label'),\n      dd_text: fupl_options.element.querySelector('.fupl-panel .fupl-dd-text'),\n      info_text: fupl_options.element.querySelector('.fupl-panel .fupl-info-text'),\n      result_wrapper: fupl_options.element.querySelector('.fupl-result')\n    });\n\n    // inserimento testi e attributi\n    if( fupl_options.required ) {\n      upl_istance.input.setAttribute('required', '');\n    }\n    if( fupl_options.multiple ) {\n      upl_istance.input.setAttribute('multiple', '');\n    }\n    upl_istance.label.insertAdjacentHTML('beforeend',\n      fupl_options.input_text[upl_istance._type][upl_istance._mode][0]\n    );\n    if(fupl_options.input_label_class) {\n      upl_istance.label.classList.add(...fupl_options.input_label_class.split(' '));\n    }\n    upl_istance.dd_text.innerHTML = fupl_options.input_text[upl_istance._type][upl_istance._mode][1];\n\n    // info text\n    upl_istance.info_text.innerHTML = 'xxx';\n\n    // aggiunta valori\n\n\n    // esecuzione init_callback, se presente\n    if( fupl_options.init_callback !== null ) {\n      fupl_options.init_callback( fupl_options );\n    }\n\n\n    //debug\n    if( fupl_options.debug ) {\n      /* eslint-disable */\n      console.groupCollapsed('FileUploader options');\n      // creazione di un oggetto bidimensinale per\n      // semplificare la rappresentazione in tabella\n      let c_options = {},\n      c_keys = Object.keys(fupl_options);\n      c_keys.sort();\n      c_keys.forEach(item => {\n        let _toStringify = typeof fupl_options[item] === 'object' &&\n        fupl_options[item] !== null &&\n          item !== 'element';\n        c_options[item] = _toStringify ? JSON.stringify(fupl_options[item], null, ' ') : fupl_options[item];\n      });\n      console.log('fupl_options');\n      console.table(c_options);\n      console.log('upl_istance');\n      console.table(upl_istance);\n      console.groupCollapsed('fupl_options');\n        console.log(fupl_options);\n      console.groupEnd();\n      console.groupCollapsed('upl_istance');\n        console.log(upl_istance);\n      console.groupEnd();\n      console.groupEnd();\n      /* eslint-enable */\n    } // end if debug\n\n\n  }; // end upl.createUploader\n\n  return upl;\n\n})(FileUploader2 || {});\n\n\n\n  // //         // aggiunta template\n  // //         var original_html = fupl_options.element.html();\n  // //         fupl_options.element.html( fupl_options.template );\n\n  // //         fupl_options.element.find('.fileupl__button').html( original_html ); //ripristino markup originale\n\n  // //         // se esiste fupl_options.label_class, la classe viene aggiunta\n  // //         if( fupl_options.label_class ) {\n  // //           original_label.addClass( fupl_options.label_class  );\n  // //         }\n\n  // //         // aggiunta del testo info per il drag & drop\n  // //         fupl_options.element.find('.fileupl__dd_text').html( fupl_options.is_multiple ? fupl_options.dd_text_multiple : fupl_options.dd_text_single );\n\n  // //         // aggiunta testo info file\n  // //         fupl_options.element.find('.fileupl__info_text')\n  // //         .html(\n  // //           (fupl_options.show_info_text ? upl.create_info_text(fupl_options) : '') +\n  // //           ((fupl_options.show_info_text && fupl_options.custom_info_text)? '<br>' : '') +\n  // //           (fupl_options.custom_info_text ? fupl_options.custom_info_text : '')\n  // //         );\n\n\n  // //         // !DRAG&DROP\n  // //         fupl_options.element\n  // //         .on( 'drag dragstart dragend dragover dragenter dragleave drop', function( e ) {\n  // //           e.preventDefault();\n  // //           e.stopPropagation();\n  // //         })\n  // //         .on( 'dragover dragenter', function() {\n  // //           fupl_options.element.addClass( fupl_options.element_dragover_class );\n  // //         })\n  // //         .on( 'dragleave dragend drop', function() {\n  // //           fupl_options.element.removeClass( fupl_options.element_dragover_class );\n  // //         })\n  // //         .on( 'drop', function( e ) {\n  // //           var err = false;\n  // //           if( !fupl_options.is_multiple && e.originalEvent.dataTransfer.files.length > 1 ) {\n\n  // //             fupl_options.alertErrorAPI('Puoi selezionare un solo file!');\n  // //             err = true;\n  // //           }\n\n  // //           if(!err) {\n  // //             upl.sendFiles( e.originalEvent.dataTransfer.files, fupl_options ); // filelist\n  // //           }\n  // //         });\n\n  // // //TODO fumoso, da riscrivere\n  // // //TODO correggere selector, possibilità non abbia id\n  // //         // !selezione tramite input\n  // //         var input_selector = '#' + _input.attr('id');\n  // //         $(document).on('change', input_selector, function () {\n  // //           upl.sendFiles( document.querySelector(input_selector).files, fupl_options ); // filelist\n  // //         });\n\n\n  //       } catch(e) { //throw \"error\"\n  //         console.error( e );// eslint-disable-line\n  //       } // finally {}\n\n  //     }); // end document.querySelectorAll(upl.global_options.selector).forEach\n\n  //   }; // end init\n\n  //   return upl;\n\n  // })(FileUploader2 || {});\n","/* globals FileUploader2:true */\n\nFileUploader2 = ( (upl) => {\n  \"use strict\";\n\n  // parametri di default condivisi da tutte le istanze\n  const default_options = {\n\n    // percorso del css FileUploader\n    css: null,\n\n    // Attiva la modalità debug che mostra in console le informazioni\n    // sulla configurazione corrente\n    debug: false,\n\n    // locales string, usata per la formattazione della stringa numerica\n    // mostrata all'utente ricavata da `max_filesize`\n    locales: 'it-IT',\n\n    // messaggio browser non compatibile\n    unsuitableBrowserMessage: 'Il tuo browser non ha tutte le funzionalità richieste da FileUploader',\n\n    // Interfaccia per l'invio di messaggi di errore\n    alert_api: (mes) => { window.alert(mes);},\n\n    // Url dello script lato server che esegue il caricamento del file\n    // per l'istanza in esame. Ha la precedenza sull'impostazione globale\n    // obbligatorio\n    url: null,\n\n    // Tipologia dei file selezionabili\n    // il valore deve corrispondere ad una delle chievi dell'array `mimetypes`\n    filetype: 'auto',\n\n    /*\n    Stringa di estensioni o mimetypes separati da virgola accettabili per l'uploader\n    corrente in aggiunta o sostituzione di quanto impostato tramite il parametro `filetype`.\n\n    L'eventuale attributo `accept` del campo input contenuto\n    nel contenitore uploader (se presente), svolge la stessa funzione.\n\n    In entrambi i casi, i valori sono presi in considerazione solo se `filetype == 'auto'`\n\n    In presenza sia del parametro che dell'attributo `accept`, viene effettuato un merge,\n    e l'attributo ha la precedenza sul parametro.\n    Se il parametro è `null` e l'attributo `accept` non è presente,\n    con `filetype == auto` vengono accettati tutti i tipi di file.\n    */\n    accept: null,\n\n    /*\n    Parametro multiple.\n    Attiva la possibilità di acquisire più file con lo stesso uploader.\n    L'attivazione di questa opzione può essere effettuata anche tramite il parametro\n    del campo `input` /se presente)\n    */\n    multiple: false,\n\n    /*\n    Parametro required.\n    Eventuale impostazione del campo come obbligatorio.\n    L'attivazione di questa opzione può essere effettuata anche tramite il parametro\n    del campo `input` /se presente)\n    */\n    required: false,\n\n    /*\n      Template dei markup utilizzati\n      - `main`         : markup principale inserito dentro l'elemento indicato da\n                         `upl.global_options.selector`. L'elemento, a cui viene inoltre\n                         aggiunta la classe `flup`, viene inoltre racchiuso in un elemento\n                         `div.flup-wrapper`\n\n      - `single_img`   : template aggiuntivo per immagini singole\n      - `multiple_imgs`: template aggiuntivo per immagini multiple\n      - `single_doc`   : template aggiuntivo per documenti singoli\n      - `multiple_docs`: template aggiuntivo per documenti multipli\n      - `no_file`      : template per indicare l'assenza di file\n\n      Consulta il readme per ulteriori dettagli.\n\n      Il markup di default utilizza classi di Boostrap 4.\n\n      L'eventuale contenuto dell'elemento originale viene eliminato (può contenere\n      un elemento type[file] per eventuale procedura di fallback)\n\n      I template possono essere alterati a piacimento, purché si mantengano le classi\n      `fupl-*` utilizzate nella procedura.\n\n      `multiple_docs` e `multple_imgs` possono essere null, in questo caso vengono utilizzati\n      gli stessi markup per singolo file\n    */\n    templates: {\n      // wrapped in <div class=\"fupl-wrapper\"><div class=\"fupl\"></div></div>\n      main: '<div class=\"fupl-result\"></div>' +\n        '<div class=\"fupl-panel\">' +\n          '<div class=\"fupl-button\">' +\n            '<label><input type=\"file\"></label>' +\n            '<div class=\"fupl-dd-text\">{</div>' +\n          '</div>' +\n          '<div class=\"fupl-info-text\"></div>' +\n        '</div>',\n\n      // contenuto di fupl-result quando non sono presenti files\n      no_file: '<div class=\"fupl-result-empty text-muted small font-italic\"></div>',\n\n      // trigger per la rimozione di un elemento da .fupl_results\n      // è aggiunto all'interno dell'elemento `.fupl-elimina`, presente in ognuno\n      // degli elementi successivi\n      // Deve essere un elemento button\n      remove_btn: '<button type=\"button\" class=\"close\" aria-label=\"Elimina\" title=\"Elimina questo file\">' +\n            '<span aria-hidden=\"true\">&times;</span>' +\n          '</button>',\n\n      single_img: '<div class=\"fupl-item\">' +\n        '<div class=\"fupl-elimina\"></div>' +\n        '<img alt=\"Immagine caricata\" class=\"img-fluid\">' +\n        '<div class=\"fupl-file-info\">' +\n          '<div class=\"text-truncate fupl-file-name\"></div>' +\n          '<div class=\"fupl-file-size\"></div>' +\n        '</div>' +\n      '</div>',\n\n      multiple_imgs: '<div class=\"fupl-item\">' +\n          '<div class=\"fupl-elimina\"></div>' +\n          '<div class=\"fupl-img\">' +\n            '<img alt=\"Immagine caricata\" class=\"img-fluid\">' +\n          '</div>' +\n          '<div class=\"fupl-file-info\">' +\n            '<div class=\"text-truncate fupl-file-name\"></div>' +\n            '<div class=\"fupl-file-size\"></div>' +\n          '</div>' +\n        '</div>',\n\n      single_doc: '<div class=\"fupl-item\">' +\n          '<div class=\"fupl-elimina\"></div>' +\n          '<div class=\"fupl-doc text-truncate\">' +\n            '<a href=\"#\" class=\"text-truncate fupl-file-name\"></a>' +\n          '</div>' +\n          '<span class=\"small ml-1 text-nowrap fupl-file-size\"></span>' +\n        '</div>',\n\n      multiple_docs: null // usa single_doc\n    },\n\n    // testo da inserire in `fupl-result-empty` per immagine non presente (`{{nofile_text}}`)\n    no_img_text: 'Nessuna immagine presente',\n\n    // testo da inserire in `fupl-result-empty` per documento (pdf o altro) non presente\n    // (`{{nofile_text}}`)\n    no_doc_text: 'Nessun file presente',\n\n    // Eventuale classe da aggiungere all'elemento FileUploader al\n    // momento dell'inizializzazione\n    element_class: null,\n\n    // Classe da aggiungere all'elemento FileUploader quando un file\n    // vi è trascinato sopra\n    element_dragover_class: 'fupl-is-dragover',\n\n    // Label da applicare da applicare all'elemento FileUploader.\n    // Se `null` e se esiste un elemento `label` all'interno dell'uploader,\n    // viene preso il testo dell'elemento\n    uploader_label_text: null,\n\n    // Opzione per l'aggiunta di un tag label prima dell'elemento uploader\n    uploader_add_label: true,\n\n    // Eventuale classe da aggiungere ad uploader_label\n    uploader_label_class: null,\n\n    /*\n    Testi del label del tag input (il primo elemento dell'array) e del testo\n    informativo per il drag &drop da inserire in `.fupl-dd-text` (il secondo elemento)\n    nelle varie combinazioni (img singola e multiple, doc singole e multipli)\n    segnaposti: ['{{input_label}}', '{{dd_text}}']\n    */\n    input_text: {\n      img: {\n        single:   [\"Seleziona un'immagine\", \"\\u2026oppure trascinala qui\"],\n        multiple: [\"Seleziona una o più immagini\", \"\\u2026oppure trascinale qui\"]\n      },\n      doc: {\n        single: [\"Seleziona un documento\", \"\\u2026oppure trascinalo qui\"],\n        multiple: [\"Seleziona uno o più documenti\", \"\\u2026oppure trascinali qui\"]\n      }\n    },\n\n    // classi da applicare al tag label dell'input[file] generato, utilizzato\n    // come pulsante per la selezione dei file\n    input_label_class: 'btn btn-outline-primary btn-sm',\n\n    // indica se mostrare o no il testo informativo su formati accettati,\n    // dimensioni immagini, ecc. Se si decide di non mostrarlo, potrebbe essere\n    // necessario rimuovere dal template l'elemento `.fupl-info-text`\n    show_info_text: true,\n\n    // stringhe aggiunte all'inizio e alla fine del testo informativo generato\n    // utilizzate solo se `custom_info_text` non è impostato\n    info_text_wrap_string: ['(', ')'],\n\n    // Stringa utilizzata per concatenare tra loro le varie parti del testo informativo generato\n    // utilizzata solo se `custom_info_text` non è impostato\n    info_text_join_string: ', ',\n\n    // Eventuale testo informativo personalizzato. se presente,\n    // sostituisce il testo generato in base ai formati, ai limiti di dimensioni, ecc.\n    custom_info_text: null,\n\n    /*\n    impostazioni per le immagini.\n    Applicate solo se filetype == 'img'.\n    Valori numerici che corrispondono alle dimensioni in pixel richieste per l'immagine.\n    I parametri img_min_* e img_max_* possono essere assegnati simultaneamente,\n    ma sono ignorati se esistono i corrispondenti parametri esatti (ad esempio,\n    se è presente img_w, i parametri img_min_w e img_max_w non vengono presi in considerazione).\n    Il valore di default di tutti i parametri è null, che significa che non vengono applicati.\n\n      * `img_min_w`: larghezza minima dell'immagine\n      * `img_max_w`: larghezza massima dell'immagine\n      * `img_w`: larghezza esatta dell'immagine\n      * `img_min_h`: altezza minima dell'immagine\n      * `img_max_h`: altezza massima dell'immagine\n      * `img_h`: altezza esatta dell'immagine\n    */\n    img_min_w   : null,\n    img_max_w   : null,\n    img_w       : null,\n    img_min_h   : null,\n    img_max_h   : null,\n    img_h       : null,\n\n    /*\n    Dimensione (peso) massima dell'immagine. Può essere un numero,\n    e in questo caso corrisponde ad una dimensione in KB, o una stringa\n    composta da un valore numerico e da un suffisso tra ‘KB’ e ‘MB’ (anche minuscoli).\n    Se il valore è null o se la stringa non viene riconosciuta,\n    non è applicato nessun limite.\n    */\n    max_filesize: null,\n\n    // Prefisso della variabile utilizzata per inviare al server i dati\n    // di ogni singolo file caricato. Il valore indicato è il nome base dell'array\n    // costruito per inviare i valori al server.\n    varname: 'file',\n\n    // Funzione richiamata dopo l'inizializzazione di ogni elemento FileUploader.\n    // La funzione viene invocata con l'oggetto di tutte le opzioni come argomento\n    init_callback: null,\n\n    /*\n    Funzione richiamata ogni volta che un file viene inviato al server.\n    La funzione viene invocata passandole un oggetto contenente:\n      * `item_id`: id univoco del documento in elaborazione\n      * `filelist_item`: oggetto filelist corrente,\n      * `img_preview` : miniatura dell'immagine in forma di stringa Base64\n        (null se si tratta di altre tipologie)\n      * `uploader_options`: oggetto `options` corrente\n      * `img_wi` e `img_he`: dimensioni in pixel dell'immagine.\n        null se non si tratta di immagini\n    */\n    upload_start_callback: null,\n\n    /*\n    Funzione richiamata ogni volta che un file viene caricato.\n    La funzione viene invocata passandole un oggetto contenente:\n      * `item_id`: id univoco del documento in elaborazione,\n      * `server_error`: null, se l'upload è stato completato correttamente oppure,\n        in caso contrario, stringa con il messaggio di errore restituito\n      * `filelist_item`: oggetto filelist corrente,\n      * `hidden_fields`: stringa con i campi hidden da inviare al server\n      * `uploader_options`: oggetto `options` corrente\n      * `img_wi` e img_he: dimensioni in pixel dell'immagine.\n        null se non si tratta di immagini\n    */\n    upload_complete_callback: null,\n\n    /*\n    Array degli eventuali elementi preregistrati, nella forma:\n      [\n        {\n\n        }\n        [...]\n      ]\n    */\n    values: []\n  };\n\n  upl.setOptions = (...custom_options) => {\n\n    if( typeof Object.assign === \"function\") {\n      return Object.assign(\n        {},\n        default_options,\n        ...custom_options\n      );\n\n    } else { // IE 11\n      let opts = {};\n      for(let i in default_options) {\n        opts[i] = default_options[i];\n        custom_options.forEach( item => {\n          if(item[i] !== undefined) {\n            opts[i] = item[i];\n          }\n        });\n      }\n      return opts;\n    }\n  };\n\n  return upl;\n\n})(FileUploader2 || {});\n"]}