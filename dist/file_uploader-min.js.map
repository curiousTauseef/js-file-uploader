{"version":3,"sources":["../js/file_uploader.js","../js/_init.js","../js/_create_uploader.js","../js/_create_item.js","../js/_set_listeners.js","../js/_send_files.js","../js/_build_hidden_fields.js","../js/_sortable.js","../js/_create_info_text.js","../js/_set_options.js","../js/_funcs_and_params.js"],"names":["FileUploader","upl","isSuitableBrowser","navigator","userAgent","indexOf","appVersion","div","document","createElement","window","init","init_options","global_options","setOptions","silent_degradation","alert","alert_messages","unsuitable_browser","unsuitable_browser_callback","css","head","insertAdjacentHTML","querySelectorAll","fupl_selector","forEach","upl_element","element_all_dataset","dataset","fupl_selector_camel_case","replace","m","toUpperCase","fupl_dataset","fupl_options","JSON","parse","element","uploader_url","Error","filetype","toLowerCase","Object","keys","mimetypes","e","console","error","json_params","i","item","concat","log","createUploader","_input","querySelector","original_label","accept_attr","accept_params","accept","split","map","trim","getAttribute","_toConsumableArray","Set","max_filesize","parse_max_filesize","locales","_fupl_options$wrapper","_fupl_options$istance","multiple","Boolean","hasAttribute","required","disabled","_type","_mode","uploader_legend_text","innerHTML","classList","add","wrapper","parentNode","insertBefore","appendChild","wrapper_extra_class","apply","uploader_legend","_class","uploader_legend_class","push","length","join","templates","main","istance_input","istance_label","istance_dd_text","istance_info_text","istance_result_wrapper","setAttribute","data_attributes","input_text","input_label_class","show_info_text","custom_info_text","create_info_text","sortable","sortable_varname","activateSortable","values","_typeof","Array","isArray","createItem","set_has_values","setListeners","init_callback","fancybox","fancybox_callback_func","debug","groupCollapsed","c_options","c_keys","sort","_toStringify","stringify","table","groupEnd","item_data","preregistered","arguments","undefined","item_markup","fupl_item_wrapper","remove_btn","fupl_file_name","name","title","fupl_file_size","size_string","wi","he","size","parse_filesize","src","fupl_url","url","href","fupl_item","loading","loading_element","fupl_item_dom","item_id","id","addEventListener","remove","prereg_id","rel_id","delete_varname","fancybox_anchor_markup","img_element","fancybox_wrapper","firstChild","extra_fields_wrapper","extra_fields","markup","value_key","varname","use_rel_id","order_value","sortable_icon","addSortableEvents","eventName","preventDefault","stopPropagation","element_dragover_class","files","dataTransfer","alert_api","too_much_files","sendFiles","filelist","disable_submit","modo","_form","closest","submit_btns","btn","uploadFile","current_item","img_preview","this_item","file","width","height","fupl_progress","fupl_loading_wrapper","xhr_error_message","xhr_error","remove_item_on_error","click","upload_start_callback","uploader_options","Promise","resolve","reject","ajax","XMLHttpRequest","open","onload","status","response","responseText","tmp_file","upload_complete_callback","server_error","statusText","onerror","upload","alternative_loading_func","perc_loaded","Math","round","loaded","total","lengthComputable","Infinity","value","alternative_loading_element","fileData","FormData","append","send","then","buildHiddenFields","filelist_item","idx","Date","now","ext","pop","type","file_format_error","maxbytes","item_parsed_size","file_size_error","feedback_size","reader","FileReader","image","Image","result","err_mes","img_w","img_exact_width_err","img_min_w","img_min_width_err","img_max_w","img_max_width_err","img_h","img_exact_height_err","img_min_h","img_min_height_err","img_max_h","img_max_height_err","img_err_start_string","readAsDataURL","errormessage","normalize_file_name","filename","converted","conversionTable","à","è","é","ì","ò","ù","À","È","É","Ì","Ò","Ù","'","|","!","\"","$","%","&","/","(",")","=","?","^","*","[","]","ç","@","#","<",">","ü","Ü","ñ","Ñ","~",":","\\","charCodeAt","charAt","hidden_fields","field_values","file_name","_key","classes","dragged_element","uploader_is_disabled","resetAll","this","effectAllowed","setData","getData","dropEffect","previousElementSibling","nextElementSibling","insertAdjacentElement","info_text","std_imgs","img_fixed_size","img_equal_min_size","img_equal_max_size","img_fixed_width","img_width_range","img_min_width","img_max_width","img_height_range","img_min_height","img_max_height","pdf_file","str","info_text_join_string","slice","info_text_wrap_string","default_options","mes","opts","no_file","img","doc","single","img_fixed_height","_len","custom_options","assign","_ret","_loop","v","auto","pdf","hasValues","items","bytes","mega","toLocaleString","maximumFractionDigits","filesize_value","unit","isNaN","substr"],"mappings":"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","sourcesContent":["/*!@preserve\n *\n * FileUploader 1\n * HTML5 / JS Async Uploader\n * Massimo Cassandro 2017-2019\n *\n */\n\n//* eslint no-console: 0, no-unused-vars: 0, no-empty:  0 */\n/* exported FileUploader */\n\n/*\n@codekit-append '_funcs_and_params.js'\n@codekit-append '_set_options.js'\n@codekit-append '_create_info_text.js'\n@codekit-append '_sortable.js'\n@codekit-append '_build_hidden_fields.js'\n@codekit-append '_send_files.js'\n@codekit-append '_set_listeners.js'\n@codekit-append '_create_item.js'\n@codekit-append '_create_uploader.js'\n\n@codekit-append '_init.js'\n\n*/\n'use strict';\nvar FileUploader = (function () {\n\n  let upl = {};\n\n  return upl;\n})();\n","FileUploader = ((upl) => {\n\n  // VARIABILI E METODI PRIVATI\n  /*\n    isSuitableBrowser\n    Verifica che il browser sia in grado di gestire le funzionalità richieste.\n    Restituisce `true` o `false`\n  */\n  const isSuitableBrowser = () => {\n    // Eliminazione IE\n    if( navigator.userAgent.indexOf('MSIE') !== -1 ||\n    navigator.appVersion.indexOf('Trident/') > -1 ||\n    navigator.userAgent.indexOf('Trident/') > -1 ){\n      return false;\n    }\n\n    var div = document.createElement( 'div' );\n    return ( ( 'draggable' in div ) || ( 'ondragstart' in div && 'ondrop' in div ) ) //TODO rimuovere ondragstart/ondrop (IE)?\n      && 'FormData' in window\n      && 'FileReader' in window\n      && 'fetch' in window;\n  };\n\n\n  /*\n    init\n    Seleziona gli elementi con l'attributo `global_options.fupl_selector` e avvia FileUploader\n    `global_options` è l'oggetto istanziato al momento di avviare FileUploader,\n    ha la stessa struttura di `default_options` (definito in _set_options.js)\n    e può sovrascrivere ogni suo elemento\n  */\n  upl.init = (init_options) => {\n\n    const global_options = upl.setOptions(init_options);\n\n    // verifica che il browser sia compatibile\n    if( !isSuitableBrowser() ) {\n      if(!global_options.silent_degradation) {\n        alert(global_options.alert_messages.unsuitable_browser);\n      }\n      if(global_options.unsuitable_browser_callback && typeof global_options.unsuitable_browser_callback === 'function') {\n        global_options.unsuitable_browser_callback();\n      }\n      return;\n    }\n\n    // caricamento CSS\n    if(global_options.css) {\n      document.head.insertAdjacentHTML('beforeend',\n        '<link rel=\"stylesheet\" href=\"' + global_options.css + '\" type=\"text/css\" media=\"all\">'\n      );\n    }\n\n    // istanze uploader\n    //---------------------------------------------------\n    document.querySelectorAll('[data-' + global_options.fupl_selector + ']').forEach( upl_element => {\n      /*\n        merge dei parametri inseriti tramite attributi `data`, in cui:\n\n        * `upl_element.dataset`:\n            tutti gli attributi inseriti singolarmente (es. data-filetype=\"img\")\n\n        * `upl_element.dataset[global_options.fupl_selector]`:\n            attributi inseriti tramite json assegnato a `data- + 'global_options.fupl_selector'`\n            (es data-file-uploader='{\"filetype\":\"img\"}')\n\n        In caso di conflitto prevalgono gli ultimi\n      */\n\n      let element_all_dataset = upl_element.dataset,\n        fupl_selector_camel_case = global_options\n          .fupl_selector.replace(/-([a-z])/g, m => m[1].toUpperCase() ),\n        fupl_dataset = upl_element.dataset[fupl_selector_camel_case],\n        fupl_options = {};\n\n      if(element_all_dataset === '') {\n        element_all_dataset = {};\n      }\n\n      if(fupl_dataset === '') {\n        fupl_dataset = {};\n      } else {\n        fupl_dataset = JSON.parse(fupl_dataset);\n      }\n\n      fupl_options = upl.setOptions(\n        global_options,\n        fupl_dataset,\n        element_all_dataset\n      );\n\n      // cancella la chiave `global_options.fupl_selector`\n      // (al solo scopo di semplificare)\n      delete fupl_options[fupl_selector_camel_case];\n\n      // aggiunta dell'elemento stesso ad  `fupl_options`:\n      fupl_options.element = upl_element;\n\n      // controllo parametri e avvio uploader\n      try {\n        //  controllo url\n        if( !fupl_options.uploader_url ) {\n          throw new Error( 'Parametro `uploader_url` non impostato' );\n        }\n\n        //  controllo parametro filetype\n        fupl_options.filetype = fupl_options.filetype.toLowerCase();\n        if( Object.keys(upl.mimetypes).indexOf(fupl_options.filetype) === -1 ) {\n          throw new Error( 'Parametro `filetype` non corretto' );\n        }\n      } catch(e) {\n        console.error( e );// eslint-disable-line\n      }\n\n      // parametri che devono essere array e che potrebbero essere presenti\n      // come attributi data (stringa)\n      const json_params = [\n        'input_text',\n        'templates',\n        'info_text_wrap_string',\n        'values',\n        'extra_fields'\n      ];\n\n\n      json_params.forEach(item => {\n        try {\n          if(typeof fupl_options[item] === 'string' ) {\n            fupl_options[item] = JSON.parse(fupl_options[item]);\n          }\n        } catch(e) {\n          console.error(`L'elemento “${item}” non è un json valido`); // eslint-disable-line\n          console.log(fupl_options.element); // eslint-disable-line\n          console.error( e );// eslint-disable-line\n        }\n      });\n\n      // interpretazione automatica di tutti i parametri booleani o null\n      for(let i in fupl_options) {\n        if(typeof fupl_options[i] === 'string' &&\n          ['true', 'false', 'null'].indexOf(fupl_options[i].toLowerCase) !== -1) {\n          fupl_options[i] = JSON.parse(fupl_options[i]);\n        }\n      }\n\n\n      new upl.createUploader(fupl_options);\n    }); // end document.querySelectorAll(fupl_selector).forEach\n  }; // end upl.init\n\n  return upl;\n\n})(FileUploader || {});\n\n","FileUploader = ((upl) => {\n\n  upl.createUploader = (fupl_options) => {\n\n    // eventuale campo input e relativo tag label\n    let _input = fupl_options.element.querySelector('input[type=\"file\"]'),\n      original_label = fupl_options.element.querySelector('label');\n\n\n    // implementazione eventuali parametro/attributo `accept`\n    if( fupl_options.filetype === 'auto' ) {\n\n      let accept_attr = [],\n        accept_params = [];\n\n      if( fupl_options.accept !== null ) {\n        accept_params = fupl_options.accept\n          .split(',').map( item => item.trim() );\n      }\n\n      if(_input && _input.getAttribute('accept') ) {\n        accept_attr = _input.getAttribute('accept')\n          .split(',').map( item => item.trim() );\n      }\n\n      // https://www.peterbe.com/plog/merge-two-arrays-without-duplicates-in-javascript\n      fupl_options.accept = [...new Set([...accept_params, ...accept_attr])];\n\n    } else {\n      fupl_options.accept = upl.mimetypes[fupl_options.filetype];\n    }\n\n    // elaborazione max_filesize\n    let max_filesize = upl.parse_max_filesize(fupl_options.max_filesize, fupl_options.locales);\n    if( max_filesize === false ) {\n      throw new Error( '\"' + fupl_options.max_filesize + '\" non è un valore corretto per `max_filesize`');\n    } else {\n      fupl_options.max_filesize = max_filesize;\n    }\n\n    // parametro o attributo multiple\n    fupl_options.multiple = Boolean(fupl_options.multiple ||\n      (_input && _input.hasAttribute('multiple') ));\n\n    // parametro o attributo required\n    fupl_options.required = Boolean(fupl_options.required ||\n      (_input && _input.hasAttribute('required') ));\n\n    // parametro o attributo disabled\n    fupl_options.disabled = Boolean(fupl_options.disabled ||\n      (_input && _input.hasAttribute('disabled') ));\n\n\n    // tipologia generale dell'uploader (img o doc) e modalità\n    // selezione file\n    fupl_options._type = fupl_options.filetype === 'img'? 'img' : 'doc';\n    fupl_options._mode = fupl_options.multiple? 'multiple' : 'single';\n\n    // testo label (da tag o parametro uploader_legend_text)\n    if( !fupl_options.uploader_legend_text && original_label) {\n      fupl_options.uploader_legend_text = original_label.innerHTML;\n    }\n    // caso in cui sia presente nessun valore\n    if ( !fupl_options.uploader_legend_text ) {\n      fupl_options.uploader_legend_text = '__legend non presente__';\n    }\n\n    // aggiunta della classe principale\n    fupl_options.element.classList.add('fupl');\n\n    // aggiunta wrapper\n    fupl_options.wrapper = document.createElement('fieldset');\n    fupl_options.element.parentNode.insertBefore(fupl_options.wrapper, fupl_options.element);\n    fupl_options.wrapper.appendChild(fupl_options.element);\n    fupl_options.wrapper.classList.add('fupl-wrapper');\n    fupl_options.wrapper.classList.add('fupl-type-' + fupl_options._type );\n    if(fupl_options.multiple) {\n      fupl_options.wrapper.classList.add('fupl-multiple');\n    }\n    // aggiunta eventuali classi personalizzate\n    if( fupl_options.wrapper_extra_class ) {\n      fupl_options.wrapper.classList.add( ...fupl_options.wrapper_extra_class.split(' ') );\n    }\n\n    // aggiunta legend uploader\n    if( fupl_options.uploader_legend ) {\n      let _class = ['fupl-legend'];\n      if( fupl_options.uploader_legend_class ) {\n        _class.push(fupl_options.uploader_legend_class);\n      }\n      if( fupl_options.required ) {\n        _class.push('required');\n      }\n\n      fupl_options.element.insertAdjacentHTML('beforebegin',\n        '<legend' + (_class.length? ' class=\"' + _class.join(' ') + '\"' : '') + '>' +\n          fupl_options.uploader_legend_text +\n        '</legend>'\n      );\n      fupl_options.wrapper.classList.add( 'fupl-has-legend' );\n    }\n\n    // aggiunta template uploader\n    fupl_options.element.innerHTML = fupl_options.templates.main;\n\n    fupl_options.istance_input = fupl_options.element.querySelector('.fupl-panel input[type=\"file\"]');\n    fupl_options.istance_label = fupl_options.element.querySelector('.fupl-panel label');\n    fupl_options.istance_dd_text = fupl_options.element.querySelector('.fupl-panel .fupl-dd-text');\n    fupl_options.istance_info_text = fupl_options.element.querySelector('.fupl-panel .fupl-info-text');\n    fupl_options.istance_result_wrapper = fupl_options.element.querySelector('.fupl-result');\n\n\n    // inserimento testi e attributi\n    // if( fupl_options.required ) {\n    //   fupl_options.istance_input.setAttribute('required', '');\n    // }\n    if( fupl_options.multiple ) {\n      fupl_options.istance_input.setAttribute('multiple', '');\n    }\n    if( fupl_options.accept !== null ) {\n      fupl_options.istance_input.setAttribute('accept', fupl_options.accept.join(','));\n    }\n\n    // aggiunta attributo data al wrapper per segnalare il required\n    if( fupl_options.required ) {\n      fupl_options.wrapper.dataset[upl.data_attributes.required] = 'true';\n    }\n\n    // aggiunta attributo disabled al wrapper\n    if( fupl_options.disabled ) {\n      fupl_options.wrapper.setAttribute('disabled', true);\n      fupl_options.wrapper.setAttribute('aria-disabled', true);\n    }\n\n\n    fupl_options.istance_label.insertAdjacentHTML('beforeend',\n      fupl_options.input_text[fupl_options._type][fupl_options._mode][0]\n    );\n    if(fupl_options.input_label_class) {\n      fupl_options.istance_label.classList.add(...fupl_options.input_label_class.split(' '));\n    }\n    fupl_options.istance_dd_text.innerHTML = fupl_options.input_text[fupl_options._type][fupl_options._mode][1];\n\n    // info text\n    if( fupl_options.show_info_text ) {\n      if(fupl_options.custom_info_text) {\n        fupl_options.istance_info_text.innerHTML = fupl_options.custom_info_text;\n      } else {\n        fupl_options.istance_info_text.innerHTML = upl.create_info_text(fupl_options);\n      }\n    }\n\n\n    // Sortable\n    if( fupl_options.sortable) {\n      if( fupl_options.multiple && fupl_options.sortable_varname ) {\n\n        upl.activateSortable(fupl_options);\n\n      } else {\n        console.error('\"sortable\" option incorrectly set'); // eslint-disable-line\n        fupl_options.sortable = false;\n      }\n\n    }\n\n    // aggiunta valori\n    // se values esiste ma è un oggetto, viene inserito in un array (non è garanzia di funzionamento)\n    // se è un altro tipo di variabile viene generato un errore\n    if(fupl_options.values) {\n      if(typeof fupl_options.values === 'object') {\n        if(!Array.isArray(fupl_options.values)) {\n          fupl_options.values = [fupl_options.values];\n        }\n      } else {\n        console.error(\"Il parametro `values` non è corretto\"); // eslint-disable-line\n      }\n    }\n\n    if( fupl_options.values && fupl_options.values.length ) {\n\n      fupl_options.values.forEach( item => {\n        upl.createItem(item, fupl_options, true); // true means that the element comes from the server\n      });\n\n    }\n    upl.set_has_values(fupl_options);\n\n    // gestione aggiunta nuovi elementi\n    upl.setListeners(fupl_options);\n\n\n    // calling init_callback, if present\n    if( fupl_options.init_callback !== null ) {\n      fupl_options.init_callback( fupl_options );\n    }\n\n    // calling fancybox_callback_func, if present\n    if( fupl_options.fancybox && fupl_options.fancybox_callback_func !== null ) {\n      fupl_options.fancybox_callback_func( fupl_options );\n    }\n\n    //debug\n    if( fupl_options.debug ) {\n      /* eslint-disable */\n      console.groupCollapsed('FileUploader options');\n        // creazione di un oggetto bidimensinale per\n        // semplificare la rappresentazione in tabella\n        let c_options = {},\n        c_keys = Object.keys(fupl_options);\n        c_keys.sort();\n        c_keys.forEach(item => {\n          let _toStringify = typeof fupl_options[item] === 'object' &&\n          fupl_options[item] !== null &&\n            item !== 'element';\n          c_options[item] = _toStringify ? JSON.stringify(fupl_options[item], null, ' ') : fupl_options[item];\n        });\n        console.table(c_options);\n        console.groupCollapsed('fupl_options');\n          console.log(fupl_options);\n        console.groupEnd();\n      console.groupEnd();\n      /* eslint-enable */\n    } // end if debug\n\n\n  }; // end upl.createUploader\n\n  return upl;\n\n})(FileUploader || {});\n","FileUploader = ((upl) => {\n\n\n  /*\n  Aggiunge un elemento a fupl_options.istance_result_wrapper\n  e imposta i necessari listeners\n\n  item_data è l'oggetto con i dati dell'elemento:\n\n  {\n    id    → identificativo univoco del file (può essere anche il percorso sul server)\n    name  → nome del file\n    url   → url per eventuale tag <a> presente nell'elemento (se immagine può essere assente o null)\n    src   → attributo `src` obbligatorio se immagine, oppure assente o null\n    wi    → larghezza in px se immagine oppure assente o null\n    he    → altezza in px se immagine oppure assente o null\n    size  → dimensione in bytes\n    loading → true se se si tratta di un elemento in fase di upload\n    [...] → eventuali campi aggiuntivi specifici dell'istanza\n  }\n\n  */\n\n  upl.createItem = (item_data, fupl_options, preregistered = false) => {\n\n    try {\n\n      let item_markup = fupl_options.templates[fupl_options._type][fupl_options._mode];\n      if( item_markup === null && fupl_options._mode === 'multiple' ) {\n        item_markup = fupl_options.templates[fupl_options._type]['single'];\n      }\n\n      let fupl_item_wrapper = document.createElement('div'); // wrapper da rimuovere al momento dell'inserimento\n      fupl_item_wrapper.innerHTML = item_markup;\n\n      // aggiunta pulsante rimozione\n      fupl_item_wrapper.querySelector('.fupl-remove').innerHTML = fupl_options.templates.remove_btn;\n\n\n\n      /*\n        aggiunta dati specifici dell'elemento:\n\n        elementi interni a fupl-item:\n          .fupl-file-name\n          .fupl-file-size\n          .fupl-img →  img\n          .fupl-img → a.href\n          .fupl-doc →  a.href\n\n      */\n\n      // nome file\n      let fupl_file_name = fupl_item_wrapper.querySelector('.fupl-file-name');\n      if(fupl_file_name && item_data.name ) {\n        fupl_file_name.innerHTML = item_data.name;\n        fupl_file_name.title = item_data.name;\n      }\n\n      // info dimensioni\n      let fupl_file_size = fupl_item_wrapper.querySelector('.fupl-file-size');\n      if(fupl_file_size ) {\n        let size_string = '';\n        if(fupl_options._type === 'img' && item_data.wi && item_data.he) {\n          size_string = item_data.wi + '&times;' + item_data.he + '<span class=\"fupl-unit\">px</span>';\n          if(item_data.size) {\n            size_string += ' &ndash; ';\n          }\n        }\n        if(item_data.size) {\n          size_string += upl.parse_filesize(item_data.size, fupl_options.locales);\n        }\n\n        fupl_file_size.innerHTML = size_string;\n      }\n\n      // immagine\n      if( fupl_options._type === 'img' ) {\n        fupl_item_wrapper.querySelector('.fupl-img').src = item_data.src;\n      }\n\n      // url\n      let fupl_url = fupl_item_wrapper.querySelector('.fupl-url');\n      if( fupl_url && item_data.url) {\n        fupl_url.href = item_data.url;\n      }\n\n      let fupl_item = fupl_item_wrapper.querySelector('.fupl-item');\n\n\n      if(item_data.loading) {\n        fupl_item.classList.add('fupl-is-uploading');\n        fupl_item.insertAdjacentHTML('beforeend',\n          fupl_options.templates.loading_element\n        );\n      }\n\n      if(fupl_options._mode === 'single') {\n        fupl_options.istance_result_wrapper.innerHTML = fupl_item_wrapper.innerHTML;\n      } else {\n\n        // se non esistono elementi caricati predentemente, si svuota il div per\n        // eliminare la scritta no file\n        if( !fupl_options.istance_result_wrapper.querySelector('.fupl-item')) {\n          fupl_options.istance_result_wrapper.innerHTML = '';\n        }\n\n        fupl_options.istance_result_wrapper.insertAdjacentHTML('beforeend',\n          fupl_item_wrapper.innerHTML\n        );\n      }\n\n      let fupl_item_dom = fupl_options.istance_result_wrapper.querySelector('.fupl-item:last-child');\n      fupl_item_dom.dataset[upl.data_attributes.item_id] = item_data.id;\n\n      // aggiunta evento trigger eliminazione elemento\n      fupl_item_dom.querySelector('.fupl-remove-trigger').addEventListener('click', () => {\n        fupl_item_dom.remove();\n\n        let prereg_id = item_data.rel_id? item_data.rel_id : item_data.id;\n\n        if(prereg_id && preregistered) {\n          fupl_options.wrapper.insertAdjacentHTML('beforeend',\n            `<input type=\"hidden\" name=\"${fupl_options.delete_varname}\" value=\"${prereg_id}\">`\n          );\n        }\n\n        // controllo se istance_result_wrapper è vuoto\n        // e impostazione di attributo e contenuti\n        upl.set_has_values(fupl_options);\n\n      });\n\n      //fancybox\n      if( fupl_options.fancybox && fupl_options._type === 'img' && item_data.url && fupl_options.fancybox_anchor_markup) {\n        // controllo esistenza tag `a.fupl-url` e aggiunta se necessario\n        if( !fupl_item_dom.querySelector('a.fupl-url') ) {\n\n          let img_element = fupl_item_dom.querySelector('.fupl-img'),\n            fancybox_wrapper = document.createElement('div');\n          fancybox_wrapper.innerHTML = fupl_options.fancybox_anchor_markup;\n\n          fancybox_wrapper = fancybox_wrapper.firstChild;\n          img_element.parentNode.insertBefore(fancybox_wrapper, img_element);\n          fancybox_wrapper.appendChild(img_element);\n        }\n\n        fupl_item_dom.querySelector('a.fupl-url').setAttribute('href', item_data.url);\n\n      }\n\n      // extra fields\n      let extra_fields_wrapper = fupl_item_dom.querySelector('.fupl-extra-fields');\n      if(fupl_options.extra_fields !== null && extra_fields_wrapper) {\n\n        fupl_options.extra_fields.forEach( item => {\n\n          extra_fields_wrapper.insertAdjacentHTML('beforeend',\n            item.markup.replace(/{{idx}}/g, item_data.id)\n              .replace(/{{val}}/g, preregistered && item_data[item.value_key]? item_data[item.value_key] : '')\n              .replace(/{{checked}}/g, preregistered && +item_data[item.value_key]? 'checked' : '')\n              .replace(/{{name}}/g, fupl_options.varname + '[' +\n                ((item.use_rel_id && item_data.rel_id)? item_data.rel_id : item_data.id) +\n                '][' + item.value_key + ']'\n              )\n          );\n        });\n      }\n\n      // sortable\n      if( fupl_options.sortable ) {\n        fupl_item_dom.setAttribute('draggable', true);\n\n        // il valore ordine comincia da zero\n        let order_value = fupl_options.istance_result_wrapper.querySelectorAll('.fupl-item').length -1;\n\n        fupl_item_dom.insertAdjacentHTML('beforeend',\n          '<input type=\"hidden\" class=\"fupl-sortable-order\" ' +\n            `name=\"${fupl_options.sortable_varname}[${item_data.id}]\" value=\"${order_value}\">`\n        );\n        if(fupl_options.sortable_icon) {\n          fupl_item_dom.querySelector('.fupl-sortable-icon').innerHTML = fupl_options.sortable_icon;\n        }\n        upl.addSortableEvents(fupl_item_dom, fupl_options);\n      }\n\n      return fupl_options.istance_result_wrapper.querySelector('.fupl-item:last-child');\n\n    } catch(e) {\n      console.error(e); // eslint-disable-line\n    }\n\n  }; // end upl.createItem\n\n  return upl;\n\n})(FileUploader || {});\n","FileUploader = ((upl) => {\n\n  // https://www.smashingmagazine.com/2018/01/drag-drop-file-uploader-vanilla-js/\n  upl.setListeners = (fupl_options) => {\n\n    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n      fupl_options.element.addEventListener(eventName, (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n      }, false);\n    });\n\n    ['dragover', 'dragenter'].forEach(eventName => {\n      fupl_options.element.addEventListener(eventName, () => {\n        fupl_options.element.classList.add( fupl_options.element_dragover_class );\n      }, false);\n    });\n\n    ['dragleave', 'dragend'].forEach(eventName => {\n      fupl_options.element.addEventListener(eventName, () => {\n        fupl_options.element.classList.remove( fupl_options.element_dragover_class );\n      }, false);\n    });\n\n    fupl_options.element.addEventListener('drop', (e) => {\n      fupl_options.element.classList.remove( fupl_options.element_dragover_class );\n      if(!fupl_options.wrapper.hasAttribute('disabled')) {\n        let files = e.dataTransfer.files;\n\n        if(files.length) { // se 0 è un riordinamento o altro evento\n          if( !fupl_options.multiple && files.length > 1 ) {\n            fupl_options.alert_api(fupl_options.alert_messages.too_much_files, fupl_options);\n          } else {\n            upl.sendFiles( files, fupl_options );\n          }\n        }\n      }\n    }, false);\n\n    // selezione tramite input\n    fupl_options.istance_input.addEventListener('change', () => {\n      upl.sendFiles( fupl_options.istance_input.files, fupl_options );\n    });\n\n  }; // end upl.setListeners\n\n  return upl;\n\n})(FileUploader || {});\n","FileUploader = ((upl) => {\n\n  /*\n\tsendFiles\n\tEsegue i controlli impostati, quindi la chiamata ajax e produce\n\til feedback per l'utente\n\t*/\n  upl.sendFiles = (filelist, fupl_options) => {\n\n\n    /*\n    disable_submit\n    disabilita il form fino a caricamento completato\n    */\n    const disable_submit = (modo) => {\n      // modo === true → disable, false → enable\n        const _form = fupl_options.element.closest('form');\n\n        if(fupl_options.disable_submit && _form) {\n          const submit_btns = _form.querySelectorAll('[type=\"submit\"]');\n\n          submit_btns.forEach( btn => {\n            btn.disabled = modo;\n          });\n\n        //BUG il listener non viene rimosso con modo == false\n        // const submitHandler = (e) => {\n        //   e.preventDefault();\n        //   //return false;\n        // };\n        // if(modo === true) {\n        //   _form.addEventListener('submit', submitHandler);\n        // } else {\n        //   if( !fupl_options.istance_result_wrapper.querySelector('.fupl-item.fupl-is-uploading')) {\n        //     _form.removeEventListener('submit', submitHandler);\n        //   }\n        // }\n        }\n      },\n\n      /*\n      uploadFile\n      esegue l'upload Ajax\n      https://www.smashingmagazine.com/2018/01/drag-drop-file-uploader-vanilla-js/\n\n      current_item contiene:\n        - `id`: id univoco dell'elemento\n        - `file`: oggetto filelist\n        - `width` e height: dimensioni in pixel dell'immagine.\n                    null se non si tratta di immagini\n        - `tmp_file`: nel caso di nuovi elementi: nome del file temporaneo\n\n      */\n      uploadFile = function ( current_item, img_preview ) {\n\n        // disabilitazione form\n        disable_submit(true);\n\n        // aggiunta elemento all'uploader\n        let this_item = upl.createItem({\n            id   : current_item.id,\n            name : current_item.file.name,\n            url  : null,\n            src  : img_preview,\n            wi   : current_item.width,\n            he   : current_item.height,\n            size : current_item.file.size,\n            loading:true\n          }, fupl_options),\n\n          fupl_progress= this_item.querySelector('.fupl-progress'),\n          fupl_loading_wrapper = this_item.querySelector('.fupl-loading'),\n\n          xhr_error_message = fupl_options.alert_messages.xhr_error.replace(/{{file_name}}/, current_item.file.name);\n\n        //console.log(this_item); // eslint-disable-line\n\n        const remove_item_on_error = () => {\n          this_item.querySelector('.fupl-remove-trigger').click();\n        };\n\n        /*\n      Funzione callback personalizzata\n      Vedi `_set_options.js` per tutti i parametri\n      */\n        if( fupl_options.upload_start_callback && typeof fupl_options.upload_start_callback === 'function') {\n          fupl_options.upload_start_callback({\n            'item'              : current_item,\n            'img_preview'       : img_preview,\n            'uploader_options'  : fupl_options\n          });\n        }\n\n        new Promise(function(resolve, reject) {\n          let ajax = new XMLHttpRequest();\n          ajax.open( 'POST', fupl_options.uploader_url, true );\n\n          ajax.onload = function() {\n\n            if( ajax.status >= 200 && ajax.status < 400 ) {\n\n              const response = JSON.parse( ajax.responseText );\n\n              /*\n              jsonResponse:\n              {\n                \"tmp_file\": \"file_temporaneo\",\n                \"error\": null\n              }\n            */\n              if(response.error) {\n\n                fupl_options.alert_api( xhr_error_message, fupl_options );\n                /* eslint-disable */\n              console.error( response.error );\n              /* eslint-enable */\n\n                reject();\n\n              } else {\n                current_item.tmp_file = response.tmp_file;\n                resolve();\n              }\n\n              /*\n            Funzione callback personalizzata\n            Vedi `_set_options.js` per tutti i parametri\n            */\n              if( fupl_options.upload_complete_callback && typeof fupl_options.upload_complete_callback === 'function') {\n                fupl_options.upload_complete_callback({\n                  'item'          : current_item,\n                  'server_error'  : response.error,\n                  'fupl_options'  : fupl_options\n                });\n              }\n\n\n            } else {\n              fupl_options.alert_api( xhr_error_message, fupl_options );\n              /* eslint-disable */\n            console.error( ajax.status, ajax.statusText );\n            console.error( ajax.responseText );\n            /* eslint-enable */\n            }\n\n            reject();\n          };\n\n          ajax.onerror = function() {\n            fupl_options.alert_api( xhr_error_message, fupl_options );\n            /* eslint-disable */\n          if(fupl_options.debug) {\n            console.error( ajax.status,  ajax.statusText );\n            console.error( ajax.responseText );\n          }\n          /* eslint-enable */\n\n            reject();\n          };\n\n          ajax.upload.addEventListener('progress', function (e) {\n            if( fupl_options.alternative_loading_func &&\n            typeof fupl_options.alternative_loading_func === 'function') {\n              fupl_options.alternative_loading_func(e, fupl_options);\n\n            } else {\n              let perc_loaded = Math.round(e.loaded / e.total * 100.0) || 0;\n\n              //console.log(e.loaded ,e.total, perc_loaded); // eslint-disable-line\n              if(fupl_progress) {\n                if(e.lengthComputable) {\n                  perc_loaded = perc_loaded === Infinity? 100 : perc_loaded;\n                  this_item.querySelector('.fupl-progress').value = perc_loaded;\n                } else {\n                  fupl_loading_wrapper.innerHTML = fupl_options.templates.alternative_loading_element;\n                  fupl_progress = null;\n                }\n              }\n            }\n          }, false);\n\n\n          let fileData = new FormData();\n          fileData.append('file', current_item.file);\n          ajax.send( fileData );\n        }) // end promise\n          .then(\n            // resolve\n            function (  ) {\n              //console.log('resolve'); // eslint-disable-line\n              this_item.classList.remove('fupl-is-uploading');\n              this_item.querySelector('.fupl-loading').remove(); // elemento loading\n\n              this_item.insertAdjacentHTML('beforeend',\n                upl.buildHiddenFields(current_item, fupl_options)\n              );\n\n              upl.set_has_values(fupl_options);\n\n              //Se non ci sono altri elemento in caricamento, disable_submit viene annullato\n              disable_submit(false);\n\n            },\n            //reject\n            function (  ) {\n              //console.log('reject'); // eslint-disable-line\n              remove_item_on_error();\n              upl.set_has_values(fupl_options);\n            }\n          );\n\n      };\n\n    if( filelist.length ) {\n\n      // https://stackoverflow.com/questions/38362231/\n      //how-to-use-promise-in-foreach-loop-of-array-to-populate-an-object\n      [...filelist].forEach(function (filelist_item, idx) {\n        try {\n\n          let current_item = {\n            id: 'fupl_item_' + Date.now() + '_' + idx, // id unico\n            file: filelist_item,\n            width: null,\n            height: null,\n            tmp_file: null\n          };\n\n          // controllo filetype (per drag&drop e browser che non supportano accept)\n          if( fupl_options.accept.length ) {\n            let ext = filelist_item.name.split('.').pop().toLowerCase();\n            if( fupl_options.accept.indexOf( filelist_item.type ) === -1 &&\n              fupl_options.accept.indexOf( '.' + ext ) === -1) {\n\n              throw fupl_options.alert_messages.file_format_error\n                .replace(/{{file_name}}/, filelist_item.name );\n            }\n          } // end controllo filetype\n\n          // controllo maxfilesize\n          if( fupl_options.max_filesize !== null ) {\n            if( filelist_item.size > fupl_options.max_filesize.maxbytes ) {\n              let item_parsed_size = upl.parse_filesize(filelist_item.size, fupl_options.locales);\n\n              throw fupl_options.alert_messages.file_size_error\n                .replace(/{{file_name}}/, filelist_item.name )\n                .replace(/{{file_size}}/, item_parsed_size )\n                .replace(/{{allowed_size}}/, fupl_options.max_filesize.feedback_size );\n\n            }\n          } // end controllo maxfilesize\n\n          // analisi immagine e caricamento\n          if(fupl_options.filetype === 'img') {\n\n            let reader  = new FileReader();\n            reader.addEventListener('load', function () {\n\n              let image = new Image();\n              image.src = reader.result;\n              image.addEventListener('load', function () {\n\n                let err_mes = [];\n                current_item.width=image.width;\n                current_item.height=image.height;\n\n                if( fupl_options.img_w && image.width !== fupl_options.img_w ) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_exact_width_err\n                      .replace(/{{image_dimension}}/, image.width)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_w)\n                  );\n\n                } else if(fupl_options.img_min_w && image.width < fupl_options.img_min_w) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_min_width_err\n                      .replace(/{{image_dimension}}/, image.width)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_min_w)\n                  );\n\n                } else if(fupl_options.img_max_w && image.width > fupl_options.img_max_w) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_max_width_err\n                      .replace(/{{image_dimension}}/, image.width)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_max_w)\n                  );\n                }\n\n                if (fupl_options.img_h && image.height !== fupl_options.img_h) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_exact_height_err\n                      .replace(/{{image_dimension}}/, image.height)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_h)\n                  );\n\n                } else if(fupl_options.img_min_h && image.height < fupl_options.img_min_h) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_min_height_err\n                      .replace(/{{image_dimension}}/, image.height)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_min_h)\n                  );\n\n                } else if(fupl_options.img_max_h && image.height > fupl_options.img_max_h) {\n                  err_mes.push(\n                    fupl_options.alert_messages.img_max_height_err\n                      .replace(/{{image_dimension}}/, image.height)\n                      .replace(/{{allowed_dimension}}/, fupl_options.img_max_h)\n                  );\n                }\n\n                if( err_mes.length ) {\n                  fupl_options.alert_api(\n                    fupl_options.alert_messages.img_err_start_string\n                      .replace(/{{file_name}}/, filelist_item.name ) + '<br>' +\n                    '<ul><li>' + err_mes.join('</li><li>') + '</li></ul>',\n                    fupl_options );\n\n                } else {\n                  uploadFile( current_item, reader.result );\n                }\n\n              }, false); // end image.addEventListener(\"load\"\n\n            }, false); // end reader.addEventListener(\"load\"\n\n            reader.readAsDataURL( filelist_item );\n\n          } else { // non immagine\n            uploadFile( current_item );\n\n          } // end if image\n\n        } catch (errormessage) {\n          fupl_options.alert_api( errormessage, fupl_options ,'error');\n        }\n      }); // end foreach\n\n    } // end if( filelist.length )\n\n  }; // end upl.sendFiles\n\n  return upl;\n\n})(FileUploader || {});\n","FileUploader = ((upl) => {\n\n  /*\n    normalize ascii chars > 127 (and more)\n  */\n  const normalize_file_name = function (filename) {\n    let converted = '';\n    const conversionTable = { // Reference table Unicode vs ASCII\n      'à' : 'a', // 224\n      'è' : 'e', // 232\n      'é' : 'e', // 233\n      'ì' : 'i', // 236\n      'ò' : 'o', // 242\n      'ù' : 'u', // 249\n      'À' : 'A', // 192\n      'È' : 'E', // 200\n      'É' : 'E', // 201\n      'Ì' : 'I', // 204\n      'Ò' : 'O', // 210\n      'Ù' : 'U', // 217\n      '\\'' : '_', // 39\n      '|' : '_', // 124\n      '!' : '_', // 33\n      '\"' : '_', // 34\n      '$' : '_', // 36\n      '%' : '_', // 37\n      '&' : '_', // 38\n      '/' : '_', // 47\n      '(' : '_', // 40\n      ')' : '_', // 41\n      '=' : '_', // 61\n      '?' : '_', // 63\n      '^' : '_', // 94\n      '*' : '_', // 42\n      '[' : '_', // 91\n      ']' : '_', // 93\n      'ç' : 'c', // 231\n      '@' : '_', // 64\n      '#' : '_', // 35\n      '<' : '_', // 60\n      '>' : '_', // 62\n      'ü' : 'u', // 252\n      'Ü' : 'U', // 220\n      'ñ' : 'n', // 241\n      'Ñ' : 'N', // 209\n      '~' : '_', // 126\n      ':' : '_',\n      '\\\\' : '_'\n    };\n\n    for(var i = 0; i < filename.length; i++) {\n      if( filename[i] in conversionTable) {\n        converted += conversionTable[filename[i]];\n\n      } else if(filename.charCodeAt(i) === 768 || filename.charCodeAt(i) === 769 ) { // accento grave e accento acuto\n        converted += '';\n\n      } else if(filename.charCodeAt(i) > 127 ) {\n        converted += '_';\n\n      } else {\n        converted += filename.charAt(i);\n      }\n    }\n\n    return converted.replace(/ /g, '_').replace(/_+/g, '_');\n  };\n\n  /*\n  Generate hidden fields with values to be sent to server\n  Returns the hidden fields html string\n  */\n  upl.buildHiddenFields = (current_item, fupl_options) => {\n\n    let hidden_fields = '',\n      field_values = {\n        'tmp_file'  : current_item.tmp_file,\n        'file_name' : normalize_file_name(current_item.file.name),\n        'size'      : current_item.file.size,\n        'type'      : current_item.file.type\n      };\n\n    if(fupl_options._type === 'img') {\n      field_values.width = current_item.width;\n      field_values.height = current_item.height;\n    }\n\n    for (let _key in field_values) {\n      hidden_fields += '<input type=\"hidden\" '+\n        'name=\"' + fupl_options.varname + '[' + current_item.id +'][' + _key + ']\" '+\n        'value=\"' + field_values[_key] +'\">';\n    }\n\n    return '<div class=\"fupl-hiddens\">' + hidden_fields + '</div>';\n\n  };\n\n  return upl;\n\n})(FileUploader || {});\n","FileUploader = ((upl) => {\n  'use strict';\n\n  /*\n    basato su\n    - https://github.com/WolfgangKurz/grabbable\n\n    altri riferimenti:\n    - https://codepen.io/therealDaze/pen/ZaoErp\n    - https://github.com/gridstack/gridstack.js\n    - https://developer.mozilla.org/it/docs/Web/API/HTML_Drag_and_Drop_API\n    - https://www.html5rocks.com/en/tutorials/dnd/basics/\n    - https://kryogenix.org/code/browser/custom-drag-image.html\n    - http://jsfiddle.net/zfnj5rv4/\n  */\n\n  const classes = {\n    // classe aggiunta all'elemento fupl_options.istance_result_wrapper se l'opzione\n    // sortable è attiva\n    wrapper_class: 'fupl-sortable',\n\n    // classe aggiunta all'elemento principale (fupl_options.element) quando\n    // si trascina un elemento. Viene eliminata al dragleave\n    sorting_class: 'fupl-sorting',\n\n    // stesso criterio, ma classe aggiunta all'elemento trascinato\n    sorting_item_class: 'fupl-item-sorting',\n\n    // classe aggiunta all'elemento in seguito all'evento dragover\n    over_item_class: 'fupl-item-dragover'\n  };\n\n  let dragged_element = null,\n    uploader_is_disabled = false;\n\n  // pulisce eventuali eventi non conclusi correttamente\n  const resetAll = () => {\n    if( dragged_element ) {\n      dragged_element.classList.remove(classes.sorting_item_class);\n\n      dragged_element.parentNode.querySelectorAll('.' + classes.over_item_class).forEach(item => {\n        item.classList.remove(classes.over_item_class);\n      });\n\n      dragged_element.closest('.fupl').classList.remove(classes.sorting_class);\n    }\n\n    dragged_element = null;\n  };\n\n  upl.addSortableEvents = (fupl_item, fupl_options) => {\n\n    // trascinamento avviato\n    fupl_item.addEventListener('dragstart', function(e) {\n\n      uploader_is_disabled = fupl_options.wrapper.disabled;\n      resetAll();\n      if(!uploader_is_disabled) {\n\n        dragged_element = this;\n\n        // aggiunta classe `.fupl-sorting` all'elemento fupl per disattivare il feedback\n        // del drag&drop esterno al browser (vedi scss/_fupl.scss)\n        fupl_options.element.classList.add(classes.sorting_class);\n\n        e.dataTransfer.effectAllowed = 'move';\n        e.dataTransfer.setData('text', 'fupl-sorting');\n\n        this.classList.add(classes.sorting_item_class);\n      }\n    }, false);\n\n    // inizio posizionamento sopra un altro elemento\n    // e.target (this) è l'elemento\n    fupl_item.addEventListener('dragenter', function(e) {\n\n      // non si attiva per file dall'esterno e per uplaoder disbilitato\n      if( e.dataTransfer.getData('text') === 'fupl-sorting' && !uploader_is_disabled) {\n        if (e.stopPropagation) {\n          e.stopPropagation(); // stops the browser from redirecting.\n        }\n        if( this !== dragged_element ) {\n          this.classList.add(classes.over_item_class);\n        }\n      }\n    }, false);\n\n    // posizionamento sopra un altro elemento\n    // e.target è l'elemento\n    fupl_item.addEventListener('dragover', function(e) {\n\n      if( e.dataTransfer.getData('text') === 'fupl-sorting' && !uploader_is_disabled ) {\n\n        if (e.preventDefault) {\n          e.preventDefault();\n        }\n        e.dataTransfer.dropEffect = 'move';\n        if( this !== dragged_element ) {\n          this.classList.add(classes.over_item_class);\n        }\n      }\n\n      return false;\n    }, false);\n\n    // uscita posizionamento sopra un altro elemento\n    // e.target è l'elemento\n    fupl_item.addEventListener('dragleave', function() {\n      this.classList.remove(classes.over_item_class);\n    }, false);\n\n    // drop e.target è l'elemento\n    fupl_item.addEventListener('drop', function(e) {\n\n      if( e.dataTransfer.getData('text') === 'fupl-sorting' && !uploader_is_disabled) {\n        if (e.stopPropagation) {\n          e.stopPropagation(); // stops the browser from redirecting.\n        }\n\n        e.preventDefault();\n\n        if(dragged_element) {\n          if(this.previousElementSibling === dragged_element && this.nextElementSibling ) {\n            this.parentNode.insertBefore(dragged_element, this.nextElementSibling);\n\n          } else if( this.nextElementSibling ) {\n            this.parentNode.insertBefore(dragged_element, this);\n\n          // se si tratta dell'ultimo elemento si mette alla fine\n          } else {\n            this.parentNode.insertAdjacentElement('beforeend', dragged_element);\n          }\n        }\n        resetAll();\n      }\n\n      return false;\n\n    }, false);\n\n    // trascinamento terminato\n    fupl_item.addEventListener('dragend', function(e) {\n\n      if( e.dataTransfer.getData('text') === 'fupl-sorting' && !uploader_is_disabled) {\n        fupl_options.element.classList.remove(classes.sorting_class);\n        resetAll();\n\n        //variable order\n        fupl_options.istance_result_wrapper.querySelectorAll('.fupl-sortable-order').forEach((item,idx) => {\n          item.value = idx;\n        });\n      }\n\n    }, false);\n  };\n\n  upl.activateSortable = (fupl_options) => {\n\n    // add classes\n    fupl_options.istance_result_wrapper.classList.add(classes.wrapper_class);\n\n  }; // end upl.activateSortable\n\n  return upl;\n\n})(FileUploader || {});\n","FileUploader = ((upl) => {\n  'use strict';\n\n\n  /**\n\t * create_info_text\n\t * Creates a string of information about the file requirements\n\t *\n\t */\n  upl.create_info_text = fupl_options => {\n    let info_text = [];\n\n    if( fupl_options.filetype === 'img' ) {\n      info_text.push( fupl_options.info_text.std_imgs );\n\n      if( fupl_options.img_w && fupl_options.img_h ) {\n        info_text.push( fupl_options.info_text.img_fixed_size );\n\n      } else {\n\n        if(fupl_options.img_min_w && fupl_options.img_min_h && fupl_options.img_min_w === fupl_options.img_min_h) {\n          info_text.push( fupl_options.info_text.img_equal_min_size );\n\n        } else if(fupl_options.img_max_w && fupl_options.img_max_h && fupl_options.img_max_w === fupl_options.img_max_h) {\n          info_text.push( fupl_options.info_text.img_equal_max_size );\n\n        } else {\n\n          if( fupl_options.img_w ) {\n            info_text.push( fupl_options.info_text.img_fixed_width );\n\n          } else if( fupl_options.img_min_w && fupl_options.img_max_w ) {\n            info_text.push( fupl_options.info_text.img_width_range );\n\n          } else if( fupl_options.img_min_w ) {\n            info_text.push( fupl_options.info_text.img_min_width );\n\n          } else if( fupl_options.img_max_w  ) {\n            info_text.push( fupl_options.info_text.img_max_width );\n          }\n\n          if( fupl_options.img_h ) {\n            info_text.push( fupl_options.info_text.img_fixed_width );\n\n          } else if( fupl_options.img_min_h && fupl_options.img_max_h ) {\n            info_text.push( fupl_options.info_text.img_height_range );\n\n          } else if( fupl_options.img_min_h ) {\n            info_text.push( fupl_options.info_text.img_min_height );\n\n          } else if( fupl_options.img_max_h  ) {\n            info_text.push( fupl_options.info_text.img_max_height );\n          }\n        }\n      }\n\n    } else if( fupl_options.filetype === 'pdf' ) {\n      info_text.push( fupl_options.info_text.pdf_file );\n    }\n\n    if( fupl_options.max_filesize !== null ) {\n      info_text.push( fupl_options.info_text.max_filesize );\n    }\n\n    info_text = info_text.map( item => {\n      return item.replace(/{{img_w}}/, fupl_options.img_w)\n        .replace(/{{img_h}}/, fupl_options.img_h)\n        .replace(/{{img_min_w}}/, fupl_options.img_min_w)\n        .replace(/{{img_min_h}}/, fupl_options.img_min_h)\n        .replace(/{{img_max_w}}/, fupl_options.img_max_w)\n        .replace(/{{img_max_h}}/, fupl_options.img_max_h)\n        .replace(/{{max_filesize}}/, fupl_options.max_filesize? fupl_options.max_filesize.feedback_size : null);\n    });\n\n    let str = info_text.join(fupl_options.info_text_join_string);\n    str = str.charAt(0).toUpperCase() + str.slice(1);\n\n    if(fupl_options.info_text_wrap_string && str) {\n      str = fupl_options.info_text_wrap_string[0] + str + fupl_options.info_text_wrap_string[1];\n    }\n    return str;\n  };\n\n  return upl;\n\n})(FileUploader || {});\n","FileUploader = ( (upl) => {\n\n  // default params\n  const default_options = {\n\n    /*\n    name of main data-* selector\n    */\n    fupl_selector : 'file-uploader',\n\n    /*\n    silent degradation\n    if true, no errors are trhown with unsuitable browsers, and\n    you can degrade to a standard input[type=\"file\"] field\n    */\n    silent_degradation: false,\n\n    /*\n      function called when an unsuitable browser is detected\n    */\n    unsuitable_browser_callback: null,\n\n    /*\n      FileUploader CSS path\n    */\n    css: null,\n\n    /*\n      If true, console shows informations about current FileUploader Configuration\n    */\n    debug: false,\n\n    /*\n      locales string, used to correctly format numbers in FileUploader info text\n    */\n    locales: 'it-IT',\n\n    /*\n    If true, it prevents items from being loaded\n\n    The presence of the disabled attribute in the .fupl-wrapper element disables the element\n    input [type = file] generated by FileUploader (HTML 5 std behavior) and prevents drag & drop.\n\n    The disabled parameter can also be set via the element attribute\n    input [type = file] of fallback, if present.\n    Be carefully about changing disabled state of the input field on the fly:\n    to have it affect the FileUploader instance, you must also modify the disabled attribute\n    of the fieldset.fupl-wrapper element.\n    */\n    disabled: false,\n\n    /*\n      error messeges interface\n      Parameters:\n        - mes  → `alert_messages` object key (`alert_messages` contains all string messages, see later)\n        - type → one of info, error, warning\n        - opts → options of current FileUploader instance\n    */\n    alert_api: (mes, opts, type = 'error') => {  // eslint-disable-line\n      window.alert(mes.replace(/(<([^>]+)>)/ig, '' ));\n    },\n\n    /*\n      Error messages\n      Mustache-like placeholders will be replaced with corresponding values\n    */\n    alert_messages: {\n\n      unsuitable_browser: 'Il tuo browser non ha tutte le funzionalità richieste ' +\n      'da questa applicazione.\\n' +\n      'Utilizza la versione più recente di Firefox, Edge, Safari, Opera o Chrome',\n\n      too_much_files: 'Puoi selezionare un solo file!', // tentativo di trascinare più file con uploader singolo\n      xhr_error: 'Si &egrave; verificato un errore nel caricamento del file “<strong>{{file_name}}</strong>”.', // errore ajax\n      file_format_error: 'Il file “<strong>{{file_name}}</strong>” è di un formato non consentito',\n      file_size_error: 'Le dimensioni di “<strong>{{file_name}}</strong>” ({{file_size}}) '+\n        'superano il valore massimo consentito ({{allowed_size}})',\n\n      // images\n      img_err_start_string: 'L\\'immagine “<strong>{{file_name}}</strong>” non è corretta:',\n      img_exact_width_err: 'Larghezza non corrispondente ({{image_dimension}}px invece di {{allowed_dimension}}px)',\n      img_min_width_err: 'Larghezza inferiore a quella minima consentita ({{image_dimension}}px invece di {{allowed_dimension}}px)',\n      img_max_width_err: 'Larghezza superiore a quella massima consentita ({{image_dimension}}px invece di {{allowed_dimension}}px)',\n      img_exact_height_err: 'Altezza non corrispondente ({{image_dimension}}px invece di {{allowed_dimension}}px)',\n      img_min_height_err: 'Altezza inferiore a quella minima consentita ({{image_dimension}}px invece di {{allowed_dimension}}px)',\n      img_max_height_err: 'Altezza superiore a quella massima consentita ({{image_dimension}}px invece di {{allowed_dimension}}px)'\n    },\n\n    /*\n      Server side script url that performs the upload to the server and\n      returns a json info string\n      Mandatory\n    */\n    uploader_url: null,\n\n\n    /*\n      Types of selectable files\n      the value must match one of the `upl.mimetypes` arrays\n    */\n    filetype: 'auto',\n\n    /*\n\n      String of extensions or mimetypes separated by commas that identify\n      alloewd files to be uploaded,\n      in addition or replacement of what is set via the `filetype` parameter.\n\n      The `accept` attribute of the input field contained\n      in the FileUploader element (if present), performs the same function.\n\n      In both cases, the values are taken into account only if `filetype == 'auto'`\n\n      In the presence of both the `accept` parameter and the `accept` attribute,\n      a merge is performed, and the accept attribute takes precedence over the parameter.\n      If this parameter is `null`, the` accept` attribute is not present,\n      and  `filetype` parameter is `auto` all file types are accepted.\n\n    */\n    accept: null,\n\n    /*\n      Enable the ability to uploader multiple files.\n      This option can also be activated via the `multiple` attribute\n      of the `input` field (if present)\n    */\n    multiple: false,\n\n    /*\n      Set the FileUploder as required\n      This option can also be activated via the `multiple` attribute\n      of the `input` field (if present)\n    */\n    required: false,\n\n    /*\n      Disable FileUploader parent form element and its submit button while\n      FileUploader is performing an upload.\n      Take care to avoid any conflicts with other behaviors of the form before actving this option\n    */\n    disable_submit: false,\n\n    /*\n      HTML templates\n\n      - `main`         : main template- It is inserted inside the `fupl_selector` element.\n                         The `flup` class is also added to this element, and is wrapped by\n                         the `.flup-wrapper` fieldset\n      - `single_img`   : single image template\n      - `multiple_imgs`: multiple images template\n      - `single_doc`   : single document template\n      - `multiple_docs`: multiple documents template\n      - `no_file`      : template used when no file is present\n\n      Take a look to the readme for more info.\n      Default markup uses some Boostrap 4 classes.\n\n      You can modify these templates as you need, but you have to preserve\n      the `fupl-*` classes\n\n      Images templates must contain the img tag.\n\n      Multiple documents and images templates can be null: single elements templates\n      are used in this case.\n    */\n    templates: {\n\n      main: '<div class=\"fupl-result\"></div>' +\n        '<div class=\"fupl-panel\">' +\n          '<div class=\"fupl-button\">' +\n            '<label><input type=\"file\"></label>' +\n            '<div class=\"fupl-dd-text\">{</div>' +\n          '</div>' +\n          '<div class=\"fupl-info-text\"></div>' +\n        '</div>',\n\n      no_file: {\n        img: '<div class=\"fupl-result-empty text-muted small font-italic\">Nessuna immagine presente</div>',\n        doc: '<div class=\"fupl-result-empty text-muted small font-italic\">Nessun file presente</div>'\n      },\n\n      /*\n        trigger for removing files\n        This markup will be placed inside the `.fupl-remove` element,\n        that must be present in the template of each FileUploader item\n        It must be a button element\n      */\n      remove_btn: '<button type=\"button\" class=\"close fupl-remove-trigger\" aria-label=\"Elimina\" title=\"Elimina questo file\">' +\n            '<span aria-hidden=\"true\">&times;</span>' +\n          '</button>',\n\n      /*\n        Markup to show uploading progress\n      */\n      loading_element: '<div class=\"fupl-loading\"><progress class=\"fupl-progress\" max=100 value=0></progress></div>',\n\n      /*\n        Alternative loading feedback, used if progress.lengthComputable == false.\n        In this case and if the `alternative_loading_func` function is not present,\n        this string replaces the `.fupl-progress` element.\n      */\n      alternative_loading_element: '<div class=\"spinner-grow text-primary\" role=\"status\">' +\n          '<span class=\"sr-only\">Loading...</span></div',\n\n      /*\n        items templates\n        if tag <a> is used, avoid `href` attribute\n      */\n      img: {\n        single: '<div class=\"fupl-item\">' +\n          '<div class=\"fupl-remove\"></div>' +\n          '<img alt=\"Immagine caricata\" class=\"img-fluid fupl-img\">' +\n          '<div class=\"fupl-file-info\">' +\n            '<div class=\"text-truncate fupl-file-name\"></div>' +\n            '<div class=\"fupl-file-size\"></div>' +\n            '<div class=\"fupl-extra-fields\"></div>' +\n          '</div>' +\n        '</div>',\n\n        multiple: '<div class=\"fupl-item\">' +\n            '<div class=\"fupl-remove\"></div>' +\n            '<div class=\"fupl-img-wrapper\">' +\n              '<img alt=\"Immagine caricata\" class=\"img-fluid fupl-img\" draggable=\"false\">' +\n            '</div>' +\n            '<div class=\"fupl-file-info\">' +\n              '<div class=\"text-truncate fupl-file-name\"></div>' +\n              '<div class=\"fupl-file-size\"></div>' +\n            '</div>' +\n            '<div class=\"fupl-extra-fields\"></div>' +\n            '<div class=\"fupl-sortable-icon\"></div>' +\n          '</div>'\n      },\n\n      doc : {\n        single: '<div class=\"fupl-item\">' +\n            '<div class=\"fupl-remove\"></div>' +\n            '<div class=\"fupl-doc text-truncate\">' +\n              '<a class=\"text-truncate fupl-file-name fupl-url\" draggable=\"false\"></a>' +\n            '</div>' +\n            '<span class=\"small ml-1 text-nowrap fupl-file-size\"></span>' +\n            '<div class=\"fupl-extra-fields\"></div>' +\n            '<div class=\"fupl-sortable-icon\"></div>' +\n          '</div>',\n\n        multiple: null // uses single doc templates\n      }\n    },\n\n    /*\n      info text strings\n      Mustache-like placeholders will be replaced with corresponding values\n    */\n    info_text: {\n      std_imgs : 'immagini in formato <strong>JPEG</strong>, <strong>PNG</strong>, <strong>GIF</strong> o <strong>WEBP</strong>',\n      img_fixed_size: 'dimensioni: <strong>{{img_w}}&times;{{img_h}}px</strong>',\n      img_equal_min_size: 'larghezza e altezza non inferiori a <strong>{{img_min_w}}px</strong>',\n      img_equal_max_size: 'larghezza e altezza non superiori a <strong>{{img_max_w}}px</strong>',\n      img_fixed_width : 'larghezza <strong>{{img_w}}px</strong>',\n      img_fixed_height : 'altezza <strong>{{img_h}}px</strong>',\n      img_width_range: 'larghezza compresa tra <strong>{{img_min_w}}px</strong> e <strong>{{img_max_w}}px</strong>',\n      img_min_width: 'larghezza non inferiore a <strong>{{img_min_w}}px</strong>',\n      img_max_width: 'larghezza non superiore a <strong>{{img_max_w}}px</strong>',\n      img_height_range: 'altezza compresa tra <strong>{{img_min_h}}px</strong> e <strong>{{img_max_h}}px</strong>',\n      img_min_height: 'altezza non inferiore a <strong>{{img_min_h}}px</strong>',\n      img_max_height: 'altezza non superiore a <strong>{{img_max_h}}px</strong>',\n      pdf_file: 'file in formato <strong>PDF</strong>',\n      max_filesize: 'max <strong>{{max_filesize}}</strong>'\n    },\n\n    /*\n      Extra classes to be added to the FileUploader wrapper element\n      (classes names separated by spaces)\n    */\n    wrapper_extra_class: null,\n\n    /*\n      Class(es) to be added to FileUploader element when a file is dragged there from desktop\n    */\n    element_dragover_class: 'fupl-is-dragover',\n\n    /*\n      If true a legend tag will be added inside the the FileUploader wrapper (fieldset)\n      It will be filled with the text of the label of the input[file] tag (if present)\n      or with the uploader_legend_text parameter content\n    */\n    uploader_legend: true,\n\n    /*\n      Text of legend element (alternative to original label text)\n    */\n    uploader_legend_text: null,\n\n    /*\n      Class to be added to uploader_legend element\n    */\n    uploader_legend_class: null,\n\n    /*\n    texts of the label of the generated input tag and of the drag&drop info text\n    (to be inserted in `.fupl-dd-text`)\n    */\n    input_text: {\n      img: {\n        single:   ['Seleziona un\\'immagine', '\\u2026oppure trascinala qui'],\n        multiple: ['Seleziona una o pi&ugrave; immagini', '\\u2026oppure trascinale qui']\n      },\n      doc: {\n        single: ['Seleziona un documento', '\\u2026oppure trascinalo qui'],\n        multiple: ['Seleziona uno o pi&ugrave; documenti', '\\u2026oppure trascinali qui']\n      }\n    },\n\n    /*\n      classes to be added to the label of the generated nput[file] tag\n    */\n    input_label_class: 'btn btn-outline-primary btn-sm',\n\n\n    /*\n      whether or not to show the information text on accepted formats, image size, etc.\n      If you decide not to show it, you may need to remove the\n      `.fupl-info-text` element from the template\n    */\n    show_info_text: true,\n\n    /*\n      strings added to the beginning and end of the generated info text\n      used only if `custom_info_text` is not set\n    */\n    info_text_wrap_string: ['(', ')'],\n\n    /*\n      String used to join the various parts of the generated info text\n      used only if `custom_info_text` is not set\n    */\n    info_text_join_string: ', ',\n\n    /*\n      Custom info text\n      If replaces the generated info text\n    */\n    custom_info_text: null,\n\n    /*\n    Images settings (only for filetype == 'img')\n\n    Numeric values that correspond to the pixel dimensions required for the image.\n    The img_min_* and img_max_* parameters can be assigned simultaneously,\n    but they are ignored if the corresponding exact parameters exist\n    (for example, if img_w is present, the parameters img_min_w and img_max_w\n    are not taken into consideration).\n    The default value of all parameters is null, which means that they are not applied.\n\n      * `img_min_w` : min image width\n      * `img_max_w` : max image width\n      * `img_w`     : exact image width\n      * `img_min_h` : min image height\n      * `img_max_h` : max image height\n      * `img_h`     : exact image height\n    */\n    img_min_w   : null,\n    img_max_w   : null,\n    img_w       : null,\n    img_min_h   : null,\n    img_max_h   : null,\n    img_h       : null,\n\n\n    /*\n      Maximum size (weight) of the image. It can be a number,\n      and in this case it corresponds to a dimension in KB, or a string\n      composed of a numeric value and a suffix between ‘KB’ and ‘MB’ (also lowercase).\n      If the value is null or if the string is not recognized,\n      no limit is applied.\n    */\n    max_filesize: null,\n\n    /*\n      Prefix of the variable used to send the data to the server.\n      The value indicates the base name of the generated varname\n    */\n    varname: 'file',\n\n    /*\n      Function called after the initialization of each FileUploader element.\n      Function is invoked passing the complete `fupl_options` obj as argument\n    */\n    init_callback: null,\n\n    /*\n      Function called each time a file upload begins.\n      Function argument is an object that contains:\n        * `item`: current item object, it contains:\n          - id: element unique id\n          - file: current filelist object\n          - `width` e `height`: null or image dimensions (pixel)\n        * `img_preview` : base64 image preview (null if not an image)\n        * `fupl_options`: options of current FileUploader instance\n    */\n    upload_start_callback: null,\n\n    /*\n      Function called each time a file has been uploaded.\n        Function argument is an object that contains:\n        * `item`: current item object, it contains:\n          - id: element unique id\n          - file: current filelist object\n          - `width` e `height`: null or image dimensions (pixel)\n          - `tmp_file`: name of temporary file saved on the server\n        * `server_error`: error message strimg (null if no error occurred)\n        * `fupl_options`: options of current FileUploader instance\n    */\n    upload_complete_callback: null,\n\n    /*\n      Alternative upload progress function (see alternative_loading_element parameter)\n      If present, it replaces the standard one\n      Function argument is an object that contains:\n        - `progress_event`: upload progress event\n        - `fupl_options`: options of current FileUploader instance\n    */\n    alternative_loading_func: null,\n\n    /*\n      JSON array of preregistered element:\n      [\n        {\n          rel_id → id of the record related to the file (it's facultative and can be null).\n                   It's usefully for many-to-many dab tables, and, if present,\n                   is the one provided for delete a file from the server\n          id     → unique id of the file (required)\n          name   → file name (required)\n          url    → url for <a> tag href attribute (if present) (facultative)\n          src    → image `src` attribute (required for images only)\n          wi     → image pixel width  (for images only)\n          he     → image pixel height  (for images only)\n          size   → bytes size\n          [...]  → extra fields, if present\n        }\n        [...]\n      ]\n    */\n    values: [],\n\n    /*\n      varname use for deleted file generated hidden fields\n    */\n    delete_varname: 'elimina_file[]',\n\n    /*\n      if true fancybox integration is activated for images\n      fancybox is not present in FileUploader, and must be loaded in the page\n      Furthermore, to activate this option, an `url` parameter must be provided\n      (see `values` option)\n    */\n    fancybox: false,\n\n    /*\n      markup of <a> tag to wrap image tags when fancybox option is active\n      if a `a.fupl-url` element is present in img templates string, this options\n      will not be used\n    */\n    fancybox_anchor_markup: '<a class=\"fupl-url\" data-fancybox=\"fupl-gallery\"></a>',\n\n    /*\n      optional function to be called after fancybox markup is applied\n      to all elements and after `init_callback`.\n      Function is invoked passing the complete `fupl_options` obj as argument\n    */\n    fancybox_callback_func: null,\n\n    // ========================================\n    // SORTABLE OPTIONS\n    // ========================================\n    /*\n      Enable the ability to rearrange items by dragging them.\n\n      This options adds one more hidden field for each file to the form, using the\n      `reorder_varname` parameter for generated varnames.\n\n      The reorder option is enabled if the reorder parameter is true, if\n      the multiple parameter is true and if the sortable_varname parameter is present\n\n      If the option is active, the values of any pre-recorded items\n      must be provided in the json `values` in the correct order\n\n      See `demo / reorder_demo.html` for a usage example\n    */\n    sortable: false,\n\n    /*\n      hidden item varname\n    */\n    sortable_varname: 'uploader_order',\n\n    /*\n      markup for dragging icon\n      to be inserted in `.fupl-sortable-icon` element,\n      that must be present in the multiple item template\n    */\n    sortable_icon: '<div title=\"Trascina per cambiare l\\'ordinamento\"></div>',\n\n    // ========================================\n    // EXTRA FIELDS\n    // ========================================\n    /*\n      Markup to be added at the end of every uploaded item.\n      It is an array of objects each of which describes a field element:\n        [\n          {\n            \"value_key\": field key,\n            \"markup\": html string\n          },\n          ...\n        ]\n\n      * `value_key` identifies the field element and corresponds to the key used\n                    also in the values object.\n      * `use_rel_id` (default false), if true, and the `values` parameter contains the\n                     `rel_id` items, the `{{name}}` variable will be generated\n                     using `rel_id` instead of `id`.\n                     Only pre-registered items will be affected by this setting (since new items\n                     never have a `rel_id`).\n                     If `use_rel_id` is true but the `rel_id`  item doesn't exist,\n                     the `id`  will be used\n\n      * `markup` is a HTML string which contains some Mustache-like placeholder:\n        - `{{idx}}`         → unique id of the element\n        - `{{val}}`         → content of value attribute, it corresponds to\n                              `values[...][value_key]` value\n        - `{{checked}}`     → if `values[...][value_key]` exists and it's different from\n                              `0`, `null` or empty string, it is replaced with the `checked` attribute,\n                              otherwise, with an empty string\n        - `{{name}}`        → is replaced with a PHP name string formed by\n                                 * the `varname` parameter\n                                 * the unique id or rel_id (according to use_rel_id setting) of the element\n                                 * the `value_key` string\n                              Example: `file[fupl_00001][caption]`\n\n      Take a look to `extra_fields_demo.html` for a working demo.\n\n    */\n    extra_fields: null\n  };\n\n  upl.setOptions = (...custom_options) => {\n\n    if( Object.assign && typeof Object.assign === 'function') {\n      return Object.assign(\n        {},\n        default_options,\n        ...custom_options\n      );\n\n    } else { // IE 11, necessario anche se non c'è il supporto IE\n      let opts = {};\n      for(let i in default_options) {\n        opts[i] = default_options[i];\n        custom_options.forEach( item => {\n          if(item[i] !== undefined) {\n            opts[i] = item[i];\n          }\n        });\n      }\n      return opts;\n    }\n  };\n\n  return upl;\n\n})(FileUploader || {});\n","FileUploader = ((upl) => {\n\n  /*\n    Mimetypes and extensions allowed according to `filetype` parameter\n    The `auto` parameter accepts all file types (except for limitations\n    added by `accept` parameter/attribute)\n  */\n  upl.mimetypes = {\n    auto : null,\n    img  : ['image/png', 'image/jpeg', 'image/pjpeg', 'image/gif', 'image/webp',\n      '.png', '.jpg', '.jpeg', '.pjpg', '.pjpeg', '.gif', '.webp'],\n    pdf  : ['application/pdf', '.pdf']\n  };\n\n  /*\n    names of data-* attributes\n  */\n  upl.data_attributes = {\n    required      : 'required',\n    hasValues     : 'hasValues', // true if preregistered files are present\n    item_id       : 'id' // unique id of each file added to FileUploader\n  };\n\n  upl.set_has_values = fupl_options => {\n    let items = fupl_options.istance_result_wrapper.querySelectorAll('.fupl-item').length;\n    fupl_options.wrapper.dataset[upl.data_attributes.hasValues] = items? 'true' : 'false';\n    if(!items) {\n      fupl_options.istance_result_wrapper.innerHTML = fupl_options.templates.no_file[fupl_options._type];\n    }\n  };\n\n\n  upl.parse_filesize = (bytes, locales) => {\n    bytes = +bytes;\n    let mega = 1024*1024;\n    if(bytes >= mega ) {\n      return (bytes/mega).toLocaleString(locales, {maximumFractionDigits: 1}) + '<span class=\"fupl-unit\">MB</span>';\n    } else {\n      return Math.round(bytes/1024).toLocaleString(locales, {maximumFractionDigits: 0}) + '<span class=\"fupl-unit\">KB</span>';\n    }\n  };\n\n\n  /*\n   Parse the `max_filesize` parameter (if exists) and returns:\n    - `null` if max_filesize === null\n    - `false` if `max_filesize` is not a correct value\n    - the object `{ maxbytes: 123456, unit: 'KB', feedback_size: '1.2KB'}`\n    where\n      - `maxbytes` is max_filesize value in bytes\n      - `unit` is one of 'KB' and 'MB'\n      - `feedback_size` is a textual representation of max_filesize\n         for the purpose of providing end user informations\n  */\n  upl.parse_max_filesize = (filesize_value, locales) =>  {\n    // max_filesize checking and parsing\n    if( filesize_value ) {\n      var maxbytes, unit, feedback_size;\n\n      if(!isNaN(filesize_value)) { //solo numero, si assume siano KB\n        maxbytes = +filesize_value;\n        unit = 'KB';\n        feedback_size = maxbytes;\n\n      } else {\n\n        unit = filesize_value.substr(-2, 2).toUpperCase();\n        maxbytes = +filesize_value.substr(0, filesize_value.length-2);\n        feedback_size = maxbytes;\n\n        if(isNaN(maxbytes) || (unit !== 'KB' && unit !== 'MB') ) {\n          return false;\n        }\n      }\n\n      // If unit is KB but value is bigger than 1MB,\n      // unit is changed\n      if( maxbytes >= 1024 && unit === 'KB') {\n        unit = 'MB';\n        feedback_size = (Math.round((maxbytes / 1024) * 100) /100);\n      }\n\n      if(unit === 'KB') {\n        maxbytes = maxbytes * 1024;\n      } else {\n        maxbytes = maxbytes * 1024 * 1024;\n      }\n\n      return {\n        //'original_value': filesize_value,\n        //'unit'         : unit,\n        'maxbytes'     : maxbytes,\n        'feedback_size': feedback_size.toLocaleString(\n          locales, {maximumFractionDigits: (unit === 'KB'? 0 : 1)}\n        ) + '<span class=\"fupl-unit\">' + unit + '</span>'\n      };\n\n    } else {\n      return null;\n    }\n  };\n\n  return upl;\n\n})(FileUploader || {});\n"]}