"use strict";
/*!@preserve
 *
 * FileUploader 2.0
 * HTML5 / JS Async Uploader
 * Massimo Cassandro 2017-2019
 *
 */var FileUploader2=function(){var e;return{}}();function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}FileUploader2=function(e){var t="file_uploader2",i=function e(){var t=document.createElement("div");return("draggable"in t||"ondragstart"in t&&"ondrop"in t)&&"FormData"in window&&"FileReader"in window};return e.init=function(t){var l=e.setOptions(t);i()?(l.css&&document.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="'+l.css+'" type="text/css" media="all">'),document.querySelectorAll("[data-file_uploader2]").forEach(function(t){var i=t.dataset,n=t.dataset.file_uploader2,a={},r;""===i&&(i={}),n=""===n?{}:JSON.parse(n),delete(a=e.setOptions(l,n,i)).file_uploader2,a.element=t;try{if(!a.url)throw new Error("Parametro `url` non impostato");if(a.filetype=a.filetype.toLowerCase(),-1===Object.keys(e.mimetypes).indexOf(a.filetype))throw new Error("Parametro `filetype` non corretto")}catch(e){console.error(e)}["input_text","templates","info_text_wrap_string","values"].forEach(function(e){try{"string"==typeof a[e]&&(a[e]=JSON.parse(a[e]))}catch(t){console.error("L'elemento “".concat(e,"” non è un json valido")),console.log(a.element),console.error(t)}}),new e.createUploader(a)})):alert(l.unsuitableBrowserMessage)},e}((FileUploader2=function(e){return e.createUploader=function(t){var i=t.element.querySelector('input[type="file"]'),l=t.element.querySelector("label");if("auto"===t.filetype){var n=[],a=[];null!==t.accept&&(a=t.accept.split(",").map(function(e){return e.trim()})),i&&i.getAttribute("accept")&&(n=i.getAttribute("accept").split(",").map(function(e){return e.trim()})),t.accept=_toConsumableArray(new Set([].concat(_toConsumableArray(a),_toConsumableArray(n))))}else t.accept=e.mimetypes[t.filetype];var r=e.parse_max_filesize(t.max_filesize,t.locales),o,s;if(!1===r)throw new Error('"'+t.max_filesize+'" non è un valore corretto per `max_filesize`');(t.max_filesize=r,t.multiple=Boolean(t.multiple||i&&i.hasAttribute("multiple")),t.required=Boolean(t.required||i&&i.hasAttribute("required")),t._type="img"===t.filetype?"img":"doc",t._mode=t.multiple?"single":"multiple",!t.uploader_label_text&&l&&(t.uploader_label_text=l.innerHTML),t.uploader_label_text||(t.uploader_label_text="__label non presente__"),t.element.classList.add("fupl"),t.wrapper=document.createElement("div"),t.element.parentNode.insertBefore(t.wrapper,t.element),t.wrapper.appendChild(t.element),t.wrapper.classList.add("fupl-wrapper"),t.wrapper.classList.add("fupl-type-"+t._type),t.multiple&&t.wrapper.classList.add("fupl-multiple"),t.element_class)&&(o=t.element.classList).add.apply(o,_toConsumableArray(t.element_class.split(" ")));if(t.uploader_add_label){var p=["fupl-label"];t.uploader_label_class&&p.push(t.uploader_label_class),t.required&&p.push("required"),t.element.insertAdjacentHTML("beforebegin",'<div class="fupl-label"><label'+(p.length?' class="'+p.join(" ")+'"':"")+">"+t.uploader_label_text+"</label></div>"),t.wrapper.classList.add("fupl-has-label")}(t.element.innerHTML=t.templates.main,t.istance_input=t.element.querySelector('.fupl-panel input[type="file"]'),t.istance_label=t.element.querySelector(".fupl-panel label"),t.istance_dd_text=t.element.querySelector(".fupl-panel .fupl-dd-text"),t.istance_info_text=t.element.querySelector(".fupl-panel .fupl-info-text"),t.istance_result_wrapper=t.element.querySelector(".fupl-result"),t.multiple&&t.istance_input.setAttribute("multiple",""),null!==t.accept&&t.istance_input.setAttribute("accept",t.accept.join(",")),t.istance_label.insertAdjacentHTML("beforeend",t.input_text[t._type][t._mode][0]),t.input_label_class)&&(s=t.istance_label.classList).add.apply(s,_toConsumableArray(t.input_label_class.split(" ")));if(t.istance_dd_text.innerHTML=t.input_text[t._type][t._mode][1],t.istance_info_text.innerHTML="xxx",t.show_info_text&&(t.custom_info_text?t.istance_info_text.innerHTML=t.custom_info_text:t.istance_info_text.innerHTML=e.create_info_text(t)),t.values&&t.values.length?(t.values.forEach(function(i){e.createItem(i,t)}),t.wrapper.dataset.hasValues="true"):t.istance_result_wrapper.innerHTML=t.templates.no_file[t._type],null!==t.init_callback&&t.init_callback(t),t.debug){console.groupCollapsed("FileUploader options");var u={},m=Object.keys(t);m.sort(),m.forEach(function(e){var i="object"===_typeof(t[e])&&null!==t[e]&&"element"!==e;u[e]=i?JSON.stringify(t[e],null," "):t[e]}),console.table(u),console.groupCollapsed("fupl_options"),console.log(t),console.groupEnd(),console.groupEnd()}},e}((FileUploader2=function(e){return e.createItem=function(e,t){var i=function e(i){var l=1048576;return(i=+i)>=l?(i/l).toLocaleString(t.locales,{maximumFractionDigits:1})+'<span class="fupl-unit">MB</span>':Math.round(i/1024).toLocaleString(t.locales,{maximumFractionDigits:0})+'<span class="fupl-unit">KB</span>'};try{var l=t.templates[t._type][t._mode];if("string"==typeof l){var n=document.createElement("div");n.innerHTML=l.trim(),n.querySelector(".fupl-elimina").innerHTML=t.templates.remove_btn,l=n,t.templates[t._type][t._mode]=n}var a=l.querySelector(".fupl-file-name");a&&e.name&&(a.innerHTML=e.name);var r=l.querySelector(".fupl-file-size");if(r){var o="";"img"===t._type&&e.wi&&e.he&&(o=e.wi+"&times;"+e.he+'<span class="fupl-unit">px</span>',e.size&&(o+=" &ndash; ")),e.size&&(o+=i(e.size)),r.innerHTML=o}t.istance_result_wrapper.insertAdjacentHTML("beforeend",l.innerHTML)}catch(e){console.error(e)}},e}((FileUploader2=function(e){return e.create_info_text=function(e){var t=[];"img"===e.filetype?(t.push("immagini in formato <strong>JPEG</strong>, <strong>PNG</strong>, <strong>GIF</strong> o <strong>WEBP</strong>"),e.img_w&&e.img_h?t.push("dimensioni: <strong>"+e.img_w+"&times;"+e.img_h+"px</strong>"):e.img_w&&e.img_h&&e.img_w===e.img_h?t.push("larghezza e altezza <strong>"+e.img_h+"px</strong>"):e.img_min_w&&e.img_min_h&&e.img_min_w===e.img_min_h?t.push("larghezza e altezza non inferiori a <strong>"+e.img_min_w+"px</strong>"):e.img_max_w&&e.img_max_h&&e.img_max_w===e.img_max_h?t.push("larghezza e altezza non superiori a <strong>"+e.img_max_w+"px</strong>"):(e.img_w?t.push("larghezza <strong>"+e.img_w+"px</strong>"):e.img_min_w&&e.img_max_w?t.push("larghezza compresa tra <strong>"+e.img_min_w+"px</strong> e <strong>"+e.img_max_w+"px</strong>"):e.img_min_w?t.push("larghezza non inferiore a <strong>"+e.img_min_w+"px</strong>"):e.img_max_w&&t.push("larghezza non superiore a <strong>"+e.img_max_w+"px</strong>"),e.img_h?t.push("altezza <strong>"+e.img_h+"px</strong>"):e.img_min_h&&e.img_max_h?t.push("altezza compresa tra <strong>"+e.img_min_h+"px</strong> e <strong>"+e.img_max_h+"px</strong>"):e.img_min_h?t.push("altezza non inferiore a <strong>"+e.img_min_h+"px</strong>"):e.img_max_h&&t.push("altezza non superiore a <strong>"+e.img_max_h+"px</strong>"))):"pdf"===e.filetype&&t.push("file in formato <strong>PDF</strong>"),null!==e.max_filesize&&t.push("max <strong>"+e.max_filesize.feedback_size+"</strong>");var i=t.join(e.info_text_join_string);return i=i.charAt(0).toUpperCase()+i.slice(1),e.info_text_wrap_string&&i&&(i=e.info_text_wrap_string[0]+i+e.info_text_wrap_string[1]),i},e}((FileUploader2=function(e){var t={css:null,debug:!1,locales:"it-IT",unsuitableBrowserMessage:"Il tuo browser non ha tutte le funzionalità richieste da FileUploader",alert_api:function e(t){window.alert(t)},url:null,filetype:"auto",accept:null,multiple:!1,required:!1,templates:{main:'<div class="fupl-result"></div><div class="fupl-panel"><div class="fupl-button"><label><input type="file"></label><div class="fupl-dd-text">{</div></div><div class="fupl-info-text"></div></div>',no_file:{img:'<div class="fupl-result-empty text-muted small font-italic">Nessuna immagine presente</div>',doc:'<div class="fupl-result-empty text-muted small font-italic">Nessun file presente</div>'},remove_btn:'<button type="button" class="close" aria-label="Elimina" title="Elimina questo file"><span aria-hidden="true">&times;</span></button>',img:{single:'<div class="fupl-item"><div class="fupl-elimina"></div><img alt="Immagine caricata" class="img-fluid"><div class="fupl-file-info"><div class="text-truncate fupl-file-name"></div><div class="fupl-file-size"></div></div></div>',multiple:'<div class="fupl-item"><div class="fupl-elimina"></div><div class="fupl-img"><img alt="Immagine caricata" class="img-fluid"></div><div class="fupl-file-info"><div class="text-truncate fupl-file-name"></div><div class="fupl-file-size"></div></div></div>'},doc:{single:'<div class="fupl-item"><div class="fupl-elimina"></div><div class="fupl-doc text-truncate"><a href="#" class="text-truncate fupl-file-name"></a></div><span class="small ml-1 text-nowrap fupl-file-size"></span></div>',multiple:null}},element_class:null,element_dragover_class:"fupl-is-dragover",uploader_label_text:null,uploader_add_label:!0,uploader_label_class:null,input_text:{img:{single:["Seleziona un'immagine","…oppure trascinala qui"],multiple:["Seleziona una o più immagini","…oppure trascinale qui"]},doc:{single:["Seleziona un documento","…oppure trascinalo qui"],multiple:["Seleziona uno o più documenti","…oppure trascinali qui"]}},input_label_class:"btn btn-outline-primary btn-sm",show_info_text:!0,info_text_wrap_string:["(",")"],info_text_join_string:", ",custom_info_text:null,img_min_w:null,img_max_w:null,img_w:null,img_min_h:null,img_max_h:null,img_h:null,max_filesize:null,varname:"file",init_callback:null,upload_start_callback:null,upload_complete_callback:null,values:[],delete_varname:'name="elimina_file[]',reorder:!1,reorder_varname:"order"};return e.setOptions=function(){for(var e=arguments.length,i=new Array(e),l=0;l<e;l++)i[l]=arguments[l];if("function"==typeof Object.assign)return Object.assign.apply(Object,[{},t].concat(i));var n=function(){var e={},l=function l(n){e[n]=t[n],i.forEach(function(t){void 0!==t[n]&&(e[n]=t[n])})};for(var n in t)l(n);return{v:e}}();return"object"===_typeof(n)?n.v:void 0},e}((FileUploader2=function(e){return e.mimetypes={auto:null,img:["image/png","image/jpeg","image/pjpeg","image/gif","image/webp",".png",".jpg",".jpeg",".pjpg",".pjpeg",".gif",".webp"],pdf:["application/pdf",".pdf"]},e.parse_max_filesize=function(e,t){if(e){var i,l,n;if(isNaN(e)){if(l=e.substr(-2,2).toUpperCase(),n=i=+e.substr(0,e.length-2),isNaN(i)||"KB"!==l&&"MB"!==l)return!1}else l="KB",n=i=+e;return i>=1024&&"KB"===l&&(l="MB",n=Math.round(i/1024*100)/100),"KB"===l?i*=1024:i=1024*i*1024,{maxbytes:i,feedback_size:n.toLocaleString(t,{maximumFractionDigits:"KB"===l?0:1})+'<span class="fupl-unit">'+l+"</span>"}}return null},e}(FileUploader2||{}))||{}))||{}))||{}))||{}))||{});
//# sourceMappingURL=file_uploader-min.js.map